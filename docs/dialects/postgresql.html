<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">



<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        
        <title>
            
    
    PostgreSQL
 &mdash;
    SQLAlchemy 1.3 Documentation

        </title>

        
            <!-- begin iterate through site-imported + sphinx environment css_files -->
                <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
                <link rel="stylesheet" href="../_static/docs.css" type="text/css" />
                <link rel="stylesheet" href="../_static/changelog.css" type="text/css" />
                <link rel="stylesheet" href="../_static/sphinx_paramlinks.css" type="text/css" />
            <!-- end iterate through site-imported + sphinx environment css_files -->
        

        

    

    <!-- begin layout.mako headers -->

    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
        <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="SQLAlchemy 1.3 Documentation" href="../index.html" />
        <link rel="up" title="方言" href="index.html" />
        <link rel="next" title="SQLite" href="sqlite.html" />
        <link rel="prev" title="オラクル" href="oracle.html" />
    <!-- end layout.mako headers -->


    </head>
    <body>
        
















<div id="docs-container">





<div id="docs-top-navigation-container" class="body-background">
<div id="docs-header">
    <div id="docs-version-header">
        Release: <span class="version-num">1.3.0b1</span>


        | Release Date: unreleased

    </div>

    <h1>SQLAlchemy 1.3 Documentation</h1>

</div>
</div>

<div id="docs-body-container">

    <div id="fixed-sidebar" class="withsidebar">


        <div id="docs-sidebar-popout">
            <h3><a href="../index.html">SQLAlchemy 1.3 Documentation</a></h3>
            <p id="sidebar-topnav">
                <a href="../contents.html">Contents</a> |
                <a href="../genindex.html">Index</a>
            </p>

            <div id="sidebar-search">
                <form class="search" action="../search.html" method="get">
                  <label>
                  Search terms:
                  <input type="text" placeholder="search..." name="q" size="12" />
                  </label>
                  <input type="hidden" name="check_keywords" value="yes" />
                  <input type="hidden" name="area" value="default" />
                </form>
            </div>

        </div>

        <div id="docs-sidebar">

        <div id="sidebar-banner">
            
        </div>

        <div id="docs-sidebar-inner">

        
        <h3>
            <a href="index.html" title="方言">方言</a>
        </h3>

        <ul>
<li><span class="link-container first"><a class="reference external" href="firebird.html">ファイアバード</a></span></li>
<li><span class="link-container first"><a class="reference external" href="mssql.html">Microsoft SQL Server</a></span></li>
<li><span class="link-container first"><a class="reference external" href="mysql.html">MySQL</a></span></li>
<li><span class="link-container first"><a class="reference external" href="oracle.html">オラクル</a></span></li>
<li class="selected"><span class="link-container first"><strong>PostgreSQL</strong><a class="paramlink headerlink reference internal" href="#">¶</a></span><ul>
<li><span class="link-container first"><a class="reference external" href="#dialect-postgresql">Support for the PostgreSQL database.</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#sequences-serial-identity">シーケンス/シリアル/ IDENTITY</a></span><ul>
<li><span class="link-container first"><a class="reference external" href="#postgresql-10-identity-columns">PostgreSQL 10のIDENTITYカラム</a></span></li>
</ul>
</li>
<li><span class="link-container first"><a class="reference external" href="#transaction-isolation-level">トランザクション分離レベル</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#remote-schema-table-introspection-and-postgresql-search-path">リモートスキーマテーブルのイントロスペクションとPostgreSQLのsearch_path</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#insert-update-returning">INSERT / UPDATE ... RETURNING</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#insert-on-conflict-upsert">INSERT ... ON CONFLICT（アップサート）</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#full-text-search">全文検索</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#from-only">からだけ...</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#postgresql-specific-index-options">PostgreSQL固有のインデックスオプション</a></span><ul>
<li><span class="link-container first"><a class="reference external" href="#partial-indexes">部分インデックス</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#operator-classes">演算子クラス</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#index-types">インデックスの種類</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#index-storage-parameters">索引記憶域パラメータ</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#indexes-with-concurrently">CONCURRENTLYのインデックス</a></span></li>
</ul>
</li>
<li><span class="link-container first"><a class="reference external" href="#postgresql-index-reflection">PostgreSQLインデックスリフレクション</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#special-reflection-options">特殊反射オプション</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#postgresql-table-options">PostgreSQLのテーブルオプション</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#array-types">ARRAYタイプ</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#json-types">JSONの種類</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#hstore-type">HSTOREタイプ</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#enum-types">ENUMの種類</a></span><ul>
<li><span class="link-container first"><a class="reference external" href="#using-enum-with-array">ARRAYでのENUMの使用</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#using-json-jsonb-with-array">ARRAYでのJSON / JSONBの使用</a></span></li>
</ul>
</li>
<li><span class="link-container first"><a class="reference external" href="#postgresql-data-types">PostgreSQLのデータ型</a></span><ul>
<li><span class="link-container first"><a class="reference external" href="#range-types">範囲タイプ</a></span></li>
</ul>
</li>
<li><span class="link-container first"><a class="reference external" href="#postgresql-constraint-types">PostgreSQLの制約の種類</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#postgresql-dml-constructs">PostgreSQLのDML構文</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#module-sqlalchemy.dialects.postgresql.psycopg2">psycopg2</a></span><ul>
<li><span class="link-container first"><a class="reference external" href="#dialect-postgresql-psycopg2-url">DBAPI</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#dialect-postgresql-psycopg2-connect">Connecting</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#psycopg2-connect-arguments">psycopg2接続引数</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#unix-domain-connections">Unixドメイン接続</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#per-statement-connection-execution-options">Per Statement / Connection実行オプション</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#psycopg2-batch-mode-fast-execution">Psycopg2バッチモード（高速実行）</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#unicode-with-psycopg2">Psycopg2のUnicode</a></span><ul>
<li><span class="link-container first"><a class="reference external" href="#disabling-native-unicode">ネイティブUnicodeを無効にする</a></span></li>
</ul>
</li>
<li><span class="link-container first"><a class="reference external" href="#bound-parameter-styles">バウンド・パラメータ・スタイル</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#transactions">トランザクション</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#psycopg2-transaction-isolation-level">Psycopg2トランザクション分離レベル</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#notice-logging">通知ログ</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#id5">HSTOREタイプ</a></span></li>
</ul>
</li>
<li><span class="link-container first"><a class="reference external" href="#module-sqlalchemy.dialects.postgresql.pg8000">pg8000</a></span><ul>
<li><span class="link-container first"><a class="reference external" href="#dialect-postgresql-pg8000-url">DBAPI</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#dialect-postgresql-pg8000-connect">Connecting</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#unicode">Unicode</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#pg8000-transaction-isolation-level">pg8000トランザクション分離レベル</a></span></li>
</ul>
</li>
<li><span class="link-container first"><a class="reference external" href="#module-sqlalchemy.dialects.postgresql.psycopg2cffi">psycopg2cffi</a></span><ul>
<li><span class="link-container first"><a class="reference external" href="#dialect-postgresql-psycopg2cffi-url">DBAPI</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#dialect-postgresql-psycopg2cffi-connect">Connecting</a></span></li>
</ul>
</li>
<li><span class="link-container first"><a class="reference external" href="#module-sqlalchemy.dialects.postgresql.pypostgresql">py-postgresql</a></span><ul>
<li><span class="link-container first"><a class="reference external" href="#dialect-postgresql-pypostgresql-url">DBAPI</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#dialect-postgresql-pypostgresql-connect">Connecting</a></span></li>
</ul>
</li>
<li><span class="link-container first"><a class="reference external" href="#module-sqlalchemy.dialects.postgresql.pygresql">pygresql</a></span><ul>
<li><span class="link-container first"><a class="reference external" href="#dialect-postgresql-pygresql-url">DBAPI</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#dialect-postgresql-pygresql-connect">Connecting</a></span></li>
</ul>
</li>
<li><span class="link-container first"><a class="reference external" href="#module-sqlalchemy.dialects.postgresql.zxjdbc">zxjdbc</a></span><ul>
<li><span class="link-container first"><a class="reference external" href="#dialect-postgresql-zxjdbc-url">DBAPI</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#dialect-postgresql-zxjdbc-connect">Connecting</a></span></li>
</ul>
</li>
</ul>
</li>
<li><span class="link-container first"><a class="reference external" href="sqlite.html">SQLite</a></span></li>
<li><span class="link-container first"><a class="reference external" href="sybase.html">Sybase</a></span></li>
</ul>



        </div>

        </div>

    </div>

    

    <div id="docs-body" class="withsidebar" >
        
<div class="section" id="module-sqlalchemy.dialects.postgresql.base">
<span id="postgresql"></span><span id="postgresql-toplevel"></span><h1>PostgreSQL<a class="headerlink" href="#module-sqlalchemy.dialects.postgresql.base" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="section" id="dialect-postgresql">
<p>Support for the PostgreSQL database.</p>
<h2>DBAPI Support<a class="headerlink" href="#dialect-postgresql" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The following dialect/DBAPI options are available.  Please refer to individual DBAPI sections for connect information.<ul class="simple">
<li><a class="reference external" href="#module-sqlalchemy.dialects.postgresql.psycopg2">psycopg2</a></li>
<li><a class="reference external" href="#module-sqlalchemy.dialects.postgresql.pg8000">pg8000</a></li>
<li><a class="reference external" href="#module-sqlalchemy.dialects.postgresql.psycopg2cffi">psycopg2cffi</a></li>
<li><a class="reference external" href="#module-sqlalchemy.dialects.postgresql.pypostgresql">py-postgresql</a></li>
<li><a class="reference external" href="#module-sqlalchemy.dialects.postgresql.pygresql">pygresql</a></li>
<li><a class="reference external" href="#module-sqlalchemy.dialects.postgresql.zxjdbc">zxJDBC for Jython</a></li>
</ul>
</p>
</div>
<div class="section" id="sequences-serial-identity">
<span id="postgresql-sequences"></span><h2>シーケンス/シリアル/ IDENTITY<a class="headerlink" href="#sequences-serial-identity" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>PostgreSQLはシーケンスをサポートしており、SQLAlchemyはこれを整数ベースの主キー列の新しい主キー値を作成するデフォルトの手段として使用します。テーブルを作成するとき、SQLAlchemyは整数ベースの主キーカラムの `` SERIAL``データ型を発行します。このデータ型は、列に対応するシーケンスとサーバ側のデフォルトを生成します。</p>
<p>主キーの生成に使用する特定の名前付きシーケンスを指定するには、：func： <a href="#id1"><span class="problematic" id="id2">`</span></a>〜sqlalchemy.schema.Sequence`構造体を使用します:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span><span class="s1">&#39;sometable&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
        <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">(</span><span class="s1">&#39;some_id_seq&#39;</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="p">)</span></pre></div>
</div>
<p>SQLAlchemyが単一のINSERT文を発行するとき、&amp;quot;最後の挿入識別子&amp;quot;を持つ契約を満たすために、RETURNING句がINSERT文に追加され、文の完了後に主キー列を返すように指定します。 RETURNING機能は、PostgreSQL 8.2以降が使用されている場合にのみ機能します。フォールバックアプローチとして、明示的にまたは暗黙的に `` SERIAL``を介して指定されたかどうかにかかわらず、シーケンスは事前に独立して実行され、後続の挿入で使用される戻り値です。 ：func： <a href="#id1"><span class="problematic" id="id2">`</span></a>〜sqlalchemy.sql.expression.insert（）`構文が&amp;quot;executemany &amp;quot;セマンティクスを使って実行されるとき、&amp;quot;最後に挿入された識別子&amp;quot;という機能は適用されないことに注意してください。この場合、RETURNING節は出されず、シーケンスは事前に実行されません。</p>
<p>デフォルトでRETURNINGの使用を強制的にオフにするには、フラグ `` implicit_returning = False``を：func： <a href="#id1"><span class="problematic" id="id2">`</span></a>.create_engine`に指定します。</p>
<div class="section" id="postgresql-10-identity-columns">
<h3>PostgreSQL 10のIDENTITYカラム<a class="headerlink" href="#postgresql-10-identity-columns" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Postgresql 10には、SERIALの使用に取って代わる新しいIDENTITY機能があります。 IDENTITYのレンダリングの組み込みサポートはまだ利用できませんが、次のコンパイルフックを使用して、SERIALの出現をIDENTITY</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.schema</span> <span class="k">import</span> <span class="n">CreateColumn</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.ext.compiler</span> <span class="k">import</span> <span class="n">compiles</span>


<span class="nd">@compiles</span><span class="p">(</span><span class="n">CreateColumn</span><span class="p">,</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">use_identity</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">compiler</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">compiler</span><span class="o">.</span><span class="n">visit_create_column</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;SERIAL&quot;</span><span class="p">,</span> <span class="s2">&quot;INT GENERATED BY DEFAULT AS IDENTITY&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span></pre></div>
</div>
<p>上記を使用して、:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span>
    <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">String</span><span class="p">)</span>
<span class="p">)</span></pre></div>
</div>
<p>バッキングデータベースで次のように生成されます:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">t</span> <span class="p">(</span>
    <span class="nb">id</span> <span class="n">INT</span> <span class="n">GENERATED</span> <span class="n">BY</span> <span class="n">DEFAULT</span> <span class="n">AS</span> <span class="n">IDENTITY</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">,</span>
    <span class="n">data</span> <span class="n">VARCHAR</span><span class="p">,</span>
    <span class="n">PRIMARY</span> <span class="n">KEY</span> <span class="p">(</span><span class="nb">id</span><span class="p">)</span>
<span class="p">)</span></pre></div>
</div>
</div>
</div>
<div class="section" id="transaction-isolation-level">
<span id="postgresql-isolation-level"></span><h2>トランザクション分離レベル<a class="headerlink" href="#transaction-isolation-level" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>すべてのPostgreSQLの方言は、：paramref： <cite>.Connection.execution_options.isolation_level`と同様に、方言固有のパラメータ：paramref：</cite> .create_engine.isolation_level`：func： <cite>.create_engine`と、引数は：meth： `.Connection.execution_options`に渡されます。非psycopg2方言を使用する場合、この機能は、コマンド `</cite> SET SESSION CHARACTERISTICS AS TRANSACTION ISOLATION LEVEL &lt;level&gt; <a href="#id1"><span class="problematic" id="id2">``</span></a>新しい接続ごとに。特殊なAUTOCOMMIT分離レベルの場合は、DBAPI固有のテクニックが使用されます。</p>
<p>func： <cite>.create_engine</cite> ::を使って隔離レベルを設定する</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span>
    <span class="s2">&quot;postgresql+pg8000://scott:tiger@localhost/test&quot;</span><span class="p">,</span>
    <span class="n">isolation_level</span><span class="o">=</span><span class="s2">&quot;READ UNCOMMITTED&quot;</span>
<span class="p">)</span></pre></div>
</div>
<p>接続ごとの実行オプションを使用して設定するには:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">connection</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">execution_options</span><span class="p">(</span>
    <span class="n">isolation_level</span><span class="o">=</span><span class="s2">&quot;READ COMMITTED&quot;</span>
<span class="p">)</span></pre></div>
</div>
<p>`` isolation_level``に有効な値は次のとおりです：</p>
<ul class="simple">
<li>`` READ COMMITTED``</li>
<li>`` READ UNCOMMITTED``</li>
<li>`` REPEATABLE READ``</li>
<li><a href="#id1"><span class="problematic" id="id2">``</span></a>シリアル化可能 ``</li>
<li>`` AUTOCOMMIT``  -  psycopg2 / pg8000のみ</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p>：ref： <cite>psycopg2_isolation_level</cite></p>
<p class="last">：ref： <cite>pg8000_isolation_level</cite></p>
</div>
</div>
<div class="section" id="remote-schema-table-introspection-and-postgresql-search-path">
<span id="postgresql-schema-reflection"></span><h2>リモートスキーマテーブルのイントロスペクションとPostgreSQLのsearch_path<a class="headerlink" href="#remote-schema-table-introspection-and-postgresql-search-path" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>** TL; DR; <a href="#id1"><span class="problematic" id="id2">**</span></a>： &amp;quot;search_path&amp;quot;変数をデフォルトの `` public``に設定し、 `` Table``の定義内で明示的に `` public``以外の名前スキーマを指定してください。</p>
<p>PostgreSQLの方言は、任意のスキーマのテーブルを反映することができます。 ：paramref： <cite>.Table.schema`引数、または：paramref：</cite> .MetaData.reflect.schema`引数は、どのスキーマがテーブルに対して検索されるかを決定します。 reflected：class： <cite>.Table`オブジェクトは、すべての場合、指定されたとおりにこの</cite> <cite>.schema``属性を保持します。しかし、これらの：class： `.Table`オブジェクトが外部キー制約を参照するテーブルに関して、</cite> <a href="#id1"><span class="problematic" id="id2">`</span></a>.schema``がどのようにそれらのリモートテーブルに表現されるかについての決定がなされなければなりません。リモートスキーマ名は、現在の <a href="#id3"><span class="problematic" id="id4">`</span></a>PostgreSQL検索パス&lt;<a class="reference external" href="http://www.postgresql.org/docs/current/static/ddl-schemas.html#DDL-SCHEMAS-PATH">http://www.postgresql.org/docs/current/static/ddl-schemas.html#DDL-SCHEMAS-PATH</a>&gt; <a href="#id5"><span class="problematic" id="id6">`</span></a>_。</p>
<p>デフォルトでは、PostgreSQLの方言は、PostgreSQL自身の `` pg_get_constraintdef（） <a href="#id1"><span class="problematic" id="id2">``</span></a>組み込みプロシージャによって奨励される動作を模倣しています。この関数は、特定の外部キー制約のサンプル定義を返します。名前がPostgreSQLスキーマの検索パスにも含まれている場合、その定義から参照されるスキーマ名は省略されます。以下の対話はこの動作を示しています:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">=&gt;</span> <span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">test_schema</span><span class="o">.</span><span class="n">referred</span><span class="p">(</span><span class="nb">id</span> <span class="n">INTEGER</span> <span class="n">PRIMARY</span> <span class="n">KEY</span><span class="p">);</span>
<span class="n">CREATE</span> <span class="n">TABLE</span>
<span class="n">test</span><span class="o">=&gt;</span> <span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">referring</span><span class="p">(</span>
<span class="n">test</span><span class="p">(</span><span class="o">&gt;</span>         <span class="nb">id</span> <span class="n">INTEGER</span> <span class="n">PRIMARY</span> <span class="n">KEY</span><span class="p">,</span>
<span class="n">test</span><span class="p">(</span><span class="o">&gt;</span>         <span class="n">referred_id</span> <span class="n">INTEGER</span> <span class="n">REFERENCES</span> <span class="n">test_schema</span><span class="o">.</span><span class="n">referred</span><span class="p">(</span><span class="nb">id</span><span class="p">));</span>
<span class="n">CREATE</span> <span class="n">TABLE</span>
<span class="n">test</span><span class="o">=&gt;</span> <span class="n">SET</span> <span class="n">search_path</span> <span class="n">TO</span> <span class="n">public</span><span class="p">,</span> <span class="n">test_schema</span><span class="p">;</span>
<span class="n">test</span><span class="o">=&gt;</span> <span class="n">SELECT</span> <span class="n">pg_catalog</span><span class="o">.</span><span class="n">pg_get_constraintdef</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">oid</span><span class="p">,</span> <span class="n">true</span><span class="p">)</span> <span class="n">FROM</span>
<span class="n">test</span><span class="o">-&gt;</span> <span class="n">pg_catalog</span><span class="o">.</span><span class="n">pg_class</span> <span class="n">c</span> <span class="n">JOIN</span> <span class="n">pg_catalog</span><span class="o">.</span><span class="n">pg_namespace</span> <span class="n">n</span>
<span class="n">test</span><span class="o">-&gt;</span> <span class="n">ON</span> <span class="n">n</span><span class="o">.</span><span class="n">oid</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">relnamespace</span>
<span class="n">test</span><span class="o">-&gt;</span> <span class="n">JOIN</span> <span class="n">pg_catalog</span><span class="o">.</span><span class="n">pg_constraint</span> <span class="n">r</span>  <span class="n">ON</span> <span class="n">c</span><span class="o">.</span><span class="n">oid</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">conrelid</span>
<span class="n">test</span><span class="o">-&gt;</span> <span class="n">WHERE</span> <span class="n">c</span><span class="o">.</span><span class="n">relname</span><span class="o">=</span><span class="s1">&#39;referring&#39;</span> <span class="n">AND</span> <span class="n">r</span><span class="o">.</span><span class="n">contype</span> <span class="o">=</span> <span class="s1">&#39;f&#39;</span>
<span class="n">test</span><span class="o">-&gt;</span> <span class="p">;</span>
               <span class="n">pg_get_constraintdef</span>
<span class="o">---------------------------------------------------</span>
 <span class="n">FOREIGN</span> <span class="n">KEY</span> <span class="p">(</span><span class="n">referred_id</span><span class="p">)</span> <span class="n">REFERENCES</span> <span class="n">referred</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span></pre></div>
</div>
<p>上記では、リモートスキーマ `` test_schema``のメンバとして `` referenced``テーブルを作成しましたが、 `` test_schema``をPGの `` search_path``に追加し、 `` pg_get_constraintdef（） ` `` FOREIGN KEY`構文では、 `` test_schema``は関数の出力に含まれていませんでした。</p>
<p>一方、検索パスを `` public``の典型的なデフォルトに戻した場合:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">=&gt;</span> <span class="n">SET</span> <span class="n">search_path</span> <span class="n">TO</span> <span class="n">public</span><span class="p">;</span>
<span class="n">SET</span></pre></div>
</div>
<p>`` pg_get_constraintdef（） <a href="#id1"><span class="problematic" id="id2">``</span></a>と同じクエリが、私たちの完全なスキーマ修飾名を返すようになりました:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">=&gt;</span> <span class="n">SELECT</span> <span class="n">pg_catalog</span><span class="o">.</span><span class="n">pg_get_constraintdef</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">oid</span><span class="p">,</span> <span class="n">true</span><span class="p">)</span> <span class="n">FROM</span>
<span class="n">test</span><span class="o">-&gt;</span> <span class="n">pg_catalog</span><span class="o">.</span><span class="n">pg_class</span> <span class="n">c</span> <span class="n">JOIN</span> <span class="n">pg_catalog</span><span class="o">.</span><span class="n">pg_namespace</span> <span class="n">n</span>
<span class="n">test</span><span class="o">-&gt;</span> <span class="n">ON</span> <span class="n">n</span><span class="o">.</span><span class="n">oid</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">relnamespace</span>
<span class="n">test</span><span class="o">-&gt;</span> <span class="n">JOIN</span> <span class="n">pg_catalog</span><span class="o">.</span><span class="n">pg_constraint</span> <span class="n">r</span>  <span class="n">ON</span> <span class="n">c</span><span class="o">.</span><span class="n">oid</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">conrelid</span>
<span class="n">test</span><span class="o">-&gt;</span> <span class="n">WHERE</span> <span class="n">c</span><span class="o">.</span><span class="n">relname</span><span class="o">=</span><span class="s1">&#39;referring&#39;</span> <span class="n">AND</span> <span class="n">r</span><span class="o">.</span><span class="n">contype</span> <span class="o">=</span> <span class="s1">&#39;f&#39;</span><span class="p">;</span>
                     <span class="n">pg_get_constraintdef</span>
<span class="o">---------------------------------------------------------------</span>
 <span class="n">FOREIGN</span> <span class="n">KEY</span> <span class="p">(</span><span class="n">referred_id</span><span class="p">)</span> <span class="n">REFERENCES</span> <span class="n">test_schema</span><span class="o">.</span><span class="n">referred</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span></pre></div>
</div>
<p>SQLAlchemyはデフォルトで `` pg_get_constraintdef（） <a href="#id1"><span class="problematic" id="id2">``</span></a>の戻り値を使用してリモートスキーマ名を決定します。つまり、 `` search_path``が `` test_schema``をインクルードするように設定されていて、次のようにテーブルリフレクションプロセスを呼び出すとします:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="k">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">MetaData</span><span class="p">,</span> <span class="n">create_engine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql://scott:tiger@localhost/test&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SET search_path TO test_schema, public&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">meta</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">referring</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;referring&#39;</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">autoload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">autoload_with</span><span class="o">=</span><span class="n">conn</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">&lt;sqlalchemy.engine.result.ResultProxy object at 0x101612ed0&gt;</span></pre></div>
</div>
<p>上記のプロセスは、スキーマなしで**という名前の：attr： <a href="#id1"><span class="problematic" id="id2">`</span></a>.MetaData.tables`コレクション`参照された <a href="#id3"><span class="problematic" id="id4">`</span></a>テーブルに配送します:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">meta</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s1">&#39;referred&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">schema</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span></pre></div>
</div>
<p>`` search_path``の設定に関係なく、参照されたスキーマが維持されるようなリフレクションの振る舞いを変更するには、 `` postgresql_ignore_search_path``オプションを使います。これは、dialect特有の引数としてclass： <cite>.Table `と同様に：meth：</cite> .MetaData.reflect`</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SET search_path TO test_schema, public&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">meta</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">referring</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;referring&#39;</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">autoload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">autoload_with</span><span class="o">=</span><span class="n">conn</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">postgresql_ignore_search_path</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">&lt;sqlalchemy.engine.result.ResultProxy object at 0x1016126d0&gt;</span></pre></div>
</div>
<p>`` test_schema.referred``をスキーマ修飾::として保存します</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">meta</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s1">&#39;test_schema.referred&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">schema</span>
<span class="go">&#39;test_schema&#39;</span></pre></div>
</div>
<div class="sidebar">
<p class="first sidebar-title">Best Practices for PostgreSQL Schema reflection</p>
<p class="last">PostgreSQLのスキーマリフレクションの動作の説明は複雑で、幅広く使用されるユースケースやユーザの好みを扱った長年の製品です。しかし、実際には、最も単純な使用パターンに固執するだけであれば、それを理解する必要はありません。 `` search_path``をデフォルトの `` public``だけにしておき、 `` public``を参照しないでください`を明示的なスキーマ名として使用し、：class：` .Table`オブジェクトを構築するときに他のすべてのスキーマ名を明示的に参照します。ここに記載されているオプションは、このガイドラインに収まることができない、またはそうでないことを希望するユーザーのみに適用されます。</p>
</div>
<p>** <strong>すべての場合</strong>、&amp;quot;default &amp;quot;スキーマは常に `` None``として反映されます。 PostgreSQLの&amp;quot;default &amp;quot;スキーマは、PostgreSQLの `` current_schema（） <a href="#id1"><span class="problematic" id="id2">``</span></a>関数が返すものです。典型的なPostgreSQLのインストールでは、これは `` public``という名前です。したがって、 `` public``（つまりデフォルト）スキーマにある別のテーブルを参照するテーブルは、 `` .schema``属性が常に `` None``に設定されます。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 0.9.2 で追加: </span>：class： <cite>.Table`と：meth：</cite> .MetaData.reflect`で受け入れられる `` postgresql_ignore_search_path``ダイアレクトレベルオプションを追加しました。</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last"><a href="#id1"><span class="problematic" id="id2">`</span></a>スキーマ検索パス&lt;<a class="reference external" href="http://www.postgresql.org/docs/9.0/static/ddl-schemas.html#DDL-SCHEMAS-PATH">http://www.postgresql.org/docs/9.0/static/ddl-schemas.html#DDL-SCHEMAS-PATH</a>&gt; <a href="#id3"><span class="problematic" id="id4">`</span></a>_  -  PostgreSQLのウェブサイトにあります。</p>
</div>
</div>
<div class="section" id="insert-update-returning">
<h2>INSERT / UPDATE ... RETURNING<a class="headerlink" href="#insert-update-returning" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>この方言は、PG 8.2の `` INSERT..RETURNING``、 `` UPDATE..RETURNING``、および `` DELETE..RETURNING``の構文をサポートしています。 `` INSERT..RETURNING``は、新しく生成された主キー識別子をフェッチするために、単一行のINSERT文にデフォルトで使用されます。明示的な `` RETURNING``節を指定するには、文ごとに：meth： <a href="#id1"><span class="problematic" id="id2">`</span></a>._UpdateBase.returning`メソッドを使用します:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># INSERT..RETURNING</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">insert</span><span class="p">()</span><span class="o">.</span><span class="n">returning</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">col1</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">col2</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">values</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">result</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># UPDATE..RETURNING</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">update</span><span class="p">()</span><span class="o">.</span><span class="n">returning</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">col1</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">col2</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">where</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="o">==</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">result</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># DELETE..RETURNING</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span><span class="o">.</span><span class="n">returning</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">col1</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">col2</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">where</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="o">==</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">result</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span></pre></div>
</div>
</div>
<div class="section" id="insert-on-conflict-upsert">
<span id="postgresql-insert-on-conflict"></span><h2>INSERT ... ON CONFLICT（アップサート）<a class="headerlink" href="#insert-on-conflict-upsert" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>バージョン9.5以降、PostgreSQLでは、 `` INSERT``文の `` ON CONFLICT``節を介して、行の&amp;quot;upserts &amp;quot;（更新または挿入）をテーブルに許可します。候補行は、その行が一意の制約に違反しない場合にのみ挿入されます。ユニークな制約違反の場合、セカンダリアクションが発生する可能性があります。これは、ターゲット行のデータを更新する必要があることを示す&amp;quot;DO UPDATE &amp;quot;か、&amp;quot;DO NOTHING &amp;quot;この行</p>
<p>競合は、既存の一意の制約とインデックスを使用して決定されます。これらの制約は、DDLに記述されているようにその名前を使用して特定することも、インデックスを構成する列と条件を記述することによって*推論することもできます。</p>
<p>SQLAlchemyはPostgreSQL特有の：func： <cite>.postgresql.dml.insert（）`関数を介して `</cite> ON CONFLICT``サポートを提供します。これは生成メソッドを提供します：meth： <cite>〜.postgresql.dml.Insert.on_conflict_do_update`と： meth： `〜.postgresql.dml.Insert.on_conflict_do_nothing</cite></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects.postgresql</span> <span class="k">import</span> <span class="n">insert</span>

<span class="n">insert_stmt</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="n">my_table</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span>
    <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;some_existing_id&#39;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="s1">&#39;inserted value&#39;</span><span class="p">)</span>

<span class="n">do_nothing_stmt</span> <span class="o">=</span> <span class="n">insert_stmt</span><span class="o">.</span><span class="n">on_conflict_do_nothing</span><span class="p">(</span>
    <span class="n">index_elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">do_nothing_stmt</span><span class="p">)</span>

<span class="n">do_update_stmt</span> <span class="o">=</span> <span class="n">insert_stmt</span><span class="o">.</span><span class="n">on_conflict_do_update</span><span class="p">(</span>
    <span class="n">constraint</span><span class="o">=</span><span class="s1">&#39;pk_my_table&#39;</span><span class="p">,</span>
    <span class="n">set_</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;updated value&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">do_update_stmt</span><span class="p">)</span></pre></div>
</div>
<p>どちらのメソッドも、名前付き制約または列推論のいずれかを使用して、競合の&amp;quot;ターゲット&amp;quot;を指定します。</p>
<ul>
<li><p class="first">：paramref： <cite>.Insert.on_conflict_do_update.index_elements`引数は、文字列名、：class：</cite> .Column`オブジェクト、および/またはSQL式要素を含むシーケンスを指定します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">do_update_stmt</span> <span class="o">=</span> <span class="n">insert_stmt</span><span class="o">.</span><span class="n">on_conflict_do_update</span><span class="p">(</span>
    <span class="n">index_elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
    <span class="n">set_</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;updated value&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">do_update_stmt</span> <span class="o">=</span> <span class="n">insert_stmt</span><span class="o">.</span><span class="n">on_conflict_do_update</span><span class="p">(</span>
    <span class="n">index_elements</span><span class="o">=</span><span class="p">[</span><span class="n">my_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">],</span>
    <span class="n">set_</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;updated value&#39;</span><span class="p">)</span>
<span class="p">)</span></pre></div>
</div>
</li>
<li><p class="first">：paramref： <cite>.Insert.on_conflict_do_update.index_elements`を使用してインデックスを推論する場合、部分インデックスは：paramref：</cite> .Insert.on_conflict_do_update.index_where`パラメータを使用して推測することができます:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects.postgresql</span> <span class="k">import</span> <span class="n">insert</span>

<span class="n">stmt</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="n">my_table</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">user_email</span><span class="o">=</span><span class="s1">&#39;a@b.com&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;inserted data&#39;</span><span class="p">)</span>
<span class="n">stmt</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">on_conflict_do_update</span><span class="p">(</span>
    <span class="n">index_elements</span><span class="o">=</span><span class="p">[</span><span class="n">my_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_email</span><span class="p">],</span>
    <span class="n">index_where</span><span class="o">=</span><span class="n">my_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_email</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">&#39;%@gmail.com&#39;</span><span class="p">),</span>
    <span class="n">set_</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">stmt</span><span class="o">.</span><span class="n">excluded</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span></pre></div>
</div>
</li>
<li><p class="first">：paramref： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Insert.on_conflict_do_update.constraint`引き数は、それを推論するのではなく直接的に指定するために使用されます。 UNIQUE制約の名前、PRIMARY KEY制約、またはINDEX</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">do_update_stmt</span> <span class="o">=</span> <span class="n">insert_stmt</span><span class="o">.</span><span class="n">on_conflict_do_update</span><span class="p">(</span>
    <span class="n">constraint</span><span class="o">=</span><span class="s1">&#39;my_table_idx_1&#39;</span><span class="p">,</span>
    <span class="n">set_</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;updated value&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">do_update_stmt</span> <span class="o">=</span> <span class="n">insert_stmt</span><span class="o">.</span><span class="n">on_conflict_do_update</span><span class="p">(</span>
    <span class="n">constraint</span><span class="o">=</span><span class="s1">&#39;my_table_pk&#39;</span><span class="p">,</span>
    <span class="n">set_</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;updated value&#39;</span><span class="p">)</span>
<span class="p">)</span></pre></div>
</div>
</li>
<li><p class="first">：paramref： <cite>.Insert.on_conflict_do_update.constraint`引数は、制約を表すSQLAlchemy構造体、例えば：class：</cite> .UniqueConstraint`、：class： <cite>.PrimaryKeyConstraint</cite>、：class：` .Index`を参照することもできます。 ：クラス： <cite>.ExcludeConstraint</cite>。この使用法では、制約に名前がある場合は、その制約が直接使用されます。それ以外の場合、制約に名前がない場合は、推論が使用されます。ここでは、制約の式とオプションのWHERE句がコンストラクトにスペルアウトされます。この使用法は、：attr： <cite>.Table.primary_key`属性を使用して：class：</cite> .Table`の名前付きまたは名前のない主キーを参照すると特に便利です:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">do_update_stmt</span> <span class="o">=</span> <span class="n">insert_stmt</span><span class="o">.</span><span class="n">on_conflict_do_update</span><span class="p">(</span>
    <span class="n">constraint</span><span class="o">=</span><span class="n">my_table</span><span class="o">.</span><span class="n">primary_key</span><span class="p">,</span>
    <span class="n">set_</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;updated value&#39;</span><span class="p">)</span>
<span class="p">)</span></pre></div>
</div>
</li>
</ul>
<p>`` ON CONFLICT ... DO UPDATE``は、新しい値と提案された挿入からの値の任意の組み合わせを使用して、既存の行の更新を実行するために使用されます。これらの値は、：paramref： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Insert.on_conflict_do_update.set_`パラメータを使用して指定します。このパラメータは、UPDATE ::の直接値で構成される辞書を受け入れます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects.postgresql</span> <span class="k">import</span> <span class="n">insert</span>

<span class="n">stmt</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="n">my_table</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;some_id&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;inserted value&#39;</span><span class="p">)</span>
<span class="n">do_update_stmt</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">on_conflict_do_update</span><span class="p">(</span>
    <span class="n">index_elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
    <span class="n">set_</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;updated value&#39;</span><span class="p">)</span>
    <span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">do_update_stmt</span><span class="p">)</span></pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">：meth： <cite>.Insert.on_conflict_do_update`メソッドは、Python側のデフォルトのUPDATE値や生成関数を考慮せず、paramref：</cite> .Column.onupdate`を使って指定されたものを考慮しません。これらの値は、：paramref： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Insert.on_conflict_do_update.set_`ディクショナリで手動で指定されていない限り、ON CONFLICTスタイルのUPDATEスタイルに対しては使用されません。</p>
</div>
<p>提案された挿入行を参照するために、特別な別名：attr： <cite>〜.postgresql.dml.Insert.excluded`は：class：</cite> .postgresql.dml.Insert`オブジェクトの属性として利用できます。このオブジェクトは：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.ColumnCollection`です。このエイリアスには、ターゲットテーブルのすべてのカラムが含まれています:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects.postgresql</span> <span class="k">import</span> <span class="n">insert</span>

<span class="n">stmt</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="n">my_table</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span>
    <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;some_id&#39;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="s1">&#39;inserted value&#39;</span><span class="p">,</span>
    <span class="n">author</span><span class="o">=</span><span class="s1">&#39;jlh&#39;</span><span class="p">)</span>
<span class="n">do_update_stmt</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">on_conflict_do_update</span><span class="p">(</span>
    <span class="n">index_elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
    <span class="n">set_</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;updated value&#39;</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="n">stmt</span><span class="o">.</span><span class="n">excluded</span><span class="o">.</span><span class="n">author</span><span class="p">)</span>
    <span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">do_update_stmt</span><span class="p">)</span></pre></div>
</div>
<p>：meth： <cite>.Insert.on_conflict_do_update`メソッドは、：paramref：</cite> .Insert.on_conflict_do_update.where`パラメータを使用してWHERE句を受け取ります。このパラメータは、UPDATE ::を受け取る行を制限します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects.postgresql</span> <span class="k">import</span> <span class="n">insert</span>

<span class="n">stmt</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="n">my_table</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span>
    <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;some_id&#39;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="s1">&#39;inserted value&#39;</span><span class="p">,</span>
    <span class="n">author</span><span class="o">=</span><span class="s1">&#39;jlh&#39;</span><span class="p">)</span>
<span class="n">on_update_stmt</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">on_conflict_do_update</span><span class="p">(</span>
    <span class="n">index_elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
    <span class="n">set_</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;updated value&#39;</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="n">stmt</span><span class="o">.</span><span class="n">excluded</span><span class="o">.</span><span class="n">author</span><span class="p">)</span>
    <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">my_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
    <span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">on_update_stmt</span><span class="p">)</span></pre></div>
</div>
<p>&amp;quot;ON CONFLICT&amp;quot;は、一意制約または除外制約との競合が発生した場合に行全体の挿入をスキップするためにも使用できます。以下は：meth： <a href="#id1"><span class="problematic" id="id2">`</span></a>〜.postgresql.dml.Insert.on_conflict_do_nothing`メソッドを使って説明しています:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects.postgresql</span> <span class="k">import</span> <span class="n">insert</span>

<span class="n">stmt</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="n">my_table</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;some_id&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;inserted value&#39;</span><span class="p">)</span>
<span class="n">stmt</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">on_conflict_do_nothing</span><span class="p">(</span><span class="n">index_elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span></pre></div>
</div>
<p>列または制約を指定せずに `` DO NOTHING``を使用すると、INSERTをスキップして一意制約または除外制約違反が発生すると、</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects.postgresql</span> <span class="k">import</span> <span class="n">insert</span>

<span class="n">stmt</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="n">my_table</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;some_id&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;inserted value&#39;</span><span class="p">)</span>
<span class="n">stmt</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">on_conflict_do_nothing</span><span class="p">()</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span></pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.1 で追加: </span>PostgreSQL ON CONFLICT句のサポートが追加されました。</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last"><a href="#id1"><span class="problematic" id="id2">`</span></a>INSERT .. ON CONFLICT &lt;<a class="reference external" href="http://www.postgresql.org/docs/current/static/sql-insert.html#SQL-ON-CONFLICT">http://www.postgresql.org/docs/current/static/sql-insert.html#SQL-ON-CONFLICT</a>&gt; <a href="#id3"><span class="problematic" id="id4">`</span></a>_  -  PostgreSQLのドキュメントにあります。</p>
</div>
</div>
<div class="section" id="full-text-search">
<span id="postgresql-match"></span><h2>全文検索<a class="headerlink" href="#full-text-search" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>SQLAlchemyはPostgreSQLの `` &#64;&#64; <a href="#id1"><span class="problematic" id="id2">``</span></a>演算子を任意のテキスト式の：meth： <a href="#id3"><span class="problematic" id="id4">`</span></a>.ColumnElement.match`メソッドで利用可能にします。 PostgreSQLの方言では、次のような式:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span><span class="p">([</span><span class="n">sometable</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;search string&quot;</span><span class="p">)])</span></pre></div>
</div>
<p>データベースに送信します:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">text</span> <span class="o">@@</span> <span class="n">to_tsquery</span><span class="p">(</span><span class="s1">&#39;search string&#39;</span><span class="p">)</span> <span class="n">FROM</span> <span class="n">table</span></pre></div>
</div>
<p>`` to_tsquery（） <a href="#id1"><span class="problematic" id="id2">``</span></a>や `` to_tsvector（） <a href="#id3"><span class="problematic" id="id4">``</span></a>などのPostgreSQLのテキスト検索関数は、standard：data： <a href="#id5"><span class="problematic" id="id6">`</span></a>.func`構造体を使って明示的に利用できます。例えば：：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span><span class="p">([</span>
    <span class="n">func</span><span class="o">.</span><span class="n">to_tsvector</span><span class="p">(</span><span class="s1">&#39;fat cats ate rats&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;cat &amp; rat&#39;</span><span class="p">)</span>
<span class="p">])</span></pre></div>
</div>
<p>::の同等物を放出する</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">to_tsvector</span><span class="p">(</span><span class="s1">&#39;fat cats ate rats&#39;</span><span class="p">)</span> <span class="o">@@</span> <span class="n">to_tsquery</span><span class="p">(</span><span class="s1">&#39;cat &amp; rat&#39;</span><span class="p">)</span></pre></div>
</div>
<p>：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.postgresql.TSVECTOR`型は、明示的なCAST</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects.postgresql</span> <span class="k">import</span> <span class="n">TSVECTOR</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="k">import</span> <span class="n">select</span><span class="p">,</span> <span class="n">cast</span>
<span class="n">select</span><span class="p">([</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;some text&quot;</span><span class="p">,</span> <span class="n">TSVECTOR</span><span class="p">)])</span></pre></div>
</div>
<p>::と同等の文を生成する</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">CAST</span><span class="p">(</span><span class="s1">&#39;some text&#39;</span> <span class="n">AS</span> <span class="n">TSVECTOR</span><span class="p">)</span> <span class="n">AS</span> <span class="n">anon_1</span></pre></div>
</div>
<p>PostgreSQLの全文検索は、PostgreSQLの「default_text_search_config」設定、GIN / GiSTインデックスの構築に使用する `` regconfig``、およびクエリ中にオプションで渡される `` regconfig``の組み合わせの影響を受けます。</p>
<p>すでに計算されているGINまたはGiSTインデックス（全文検索でよく見られる）に対してフルテキスト検索を実行するときは、特定のPostgresSQLの `` regconfig``値を明示的に渡す必要があります。クエリプランナはインデックスを使用し、必要に応じて列を再計算しません。</p>
<p>この明示的なクエリ計画を提供するため、または異なる検索戦略を使用するために、 `` match``メソッドは `` postgresql_regconfig``キーワード引数を受け取ります:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span><span class="p">([</span><span class="n">mytable</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">])</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">mytable</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;somestring&#39;</span><span class="p">,</span> <span class="n">postgresql_regconfig</span><span class="o">=</span><span class="s1">&#39;english&#39;</span><span class="p">)</span>
<span class="p">)</span></pre></div>
</div>
<p>::の同等物を放出する</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">mytable</span><span class="o">.</span><span class="n">id</span> <span class="n">FROM</span> <span class="n">mytable</span>
<span class="n">WHERE</span> <span class="n">mytable</span><span class="o">.</span><span class="n">title</span> <span class="o">@@</span> <span class="n">to_tsquery</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">,</span> <span class="s1">&#39;somestring&#39;</span><span class="p">)</span></pre></div>
</div>
<p>また、 `` regconfig &amp;#39;&amp;#39;の値を初期引数として `` to_tsvector（） <a href="#id1"><span class="problematic" id="id2">``</span></a>コマンドに渡すこともできます:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span><span class="p">([</span><span class="n">mytable</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">])</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">func</span><span class="o">.</span><span class="n">to_tsvector</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">,</span> <span class="n">mytable</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">title</span> <span class="p">)</span>\
        <span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;somestring&#39;</span><span class="p">,</span> <span class="n">postgresql_regconfig</span><span class="o">=</span><span class="s1">&#39;english&#39;</span><span class="p">)</span>
    <span class="p">)</span></pre></div>
</div>
<p>::と同等の文を生成する</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">mytable</span><span class="o">.</span><span class="n">id</span> <span class="n">FROM</span> <span class="n">mytable</span>
<span class="n">WHERE</span> <span class="n">to_tsvector</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">,</span> <span class="n">mytable</span><span class="o">.</span><span class="n">title</span><span class="p">)</span> <span class="o">@@</span>
    <span class="n">to_tsquery</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">,</span> <span class="s1">&#39;somestring&#39;</span><span class="p">)</span></pre></div>
</div>
<p>全文検索のために作成したインデックスをフルに活用するSQLAlchemyを使ってクエリを生成するには、PostgresSQLの `` EXPLAIN ANALYZE ... <a href="#id1"><span class="problematic" id="id2">``</span></a>ツールを使うことをお勧めします。</p>
</div>
<div class="section" id="from-only">
<h2>からだけ...<a class="headerlink" href="#from-only" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>ダイアレクトは、継承階層内の特定のテーブルのみを対象とするためのPostgreSQLのONLYキーワードをサポートしています。これは `` SELECT ... FROM ONLY``、 `` UPDATE ONLY ... <a href="#id1"><span class="problematic" id="id2">``</span></a>、 `` DELETE FROM ONLY ... <a href="#id3"><span class="problematic" id="id4">``</span></a>構文を生成するために使用できます。それはSQLAlchemyのヒントメカニズムを使用します:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># SELECT ... FROM ONLY ...</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">with_hint</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="s1">&#39;ONLY&#39;</span><span class="p">,</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">result</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># UPDATE ONLY ...</span>
<span class="n">table</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">foo</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">with_hint</span><span class="p">(</span><span class="s1">&#39;ONLY&#39;</span><span class="p">,</span>
                                               <span class="n">dialect_name</span><span class="o">=</span><span class="s1">&#39;postgresql&#39;</span><span class="p">)</span>

<span class="c1"># DELETE FROM ONLY ...</span>
<span class="n">table</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span><span class="o">.</span><span class="n">with_hint</span><span class="p">(</span><span class="s1">&#39;ONLY&#39;</span><span class="p">,</span> <span class="n">dialect_name</span><span class="o">=</span><span class="s1">&#39;postgresql&#39;</span><span class="p">)</span></pre></div>
</div>
</div>
<div class="section" id="postgresql-specific-index-options">
<span id="postgresql-indexes"></span><h2>PostgreSQL固有のインデックスオプション<a class="headerlink" href="#postgresql-specific-index-options" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>PostgreSQLの方言に特有の：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Index`構造のいくつかの拡張が利用できます。</p>
<div class="section" id="partial-indexes">
<span id="postgresql-partial-indexes"></span><h3>部分インデックス<a class="headerlink" href="#partial-indexes" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>部分的な索引は、索引が行のサブセットに適用されるように、索引定義に基準を追加します。これらは、 `` postgresql_where``キーワード引数を使って：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Index`で指定することができます:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Index</span><span class="p">(</span><span class="s1">&#39;my_index&#39;</span><span class="p">,</span> <span class="n">my_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">postgresql_where</span><span class="o">=</span><span class="n">my_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span></pre></div>
</div>
</div>
<div class="section" id="operator-classes">
<h3>演算子クラス<a class="headerlink" href="#operator-classes" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>PostgreSQLでは、インデックスの各カラムに対して*演算子クラス*を指定できます（<a class="reference external" href="http://www.postgresql.org/docs/8.3/interactive/indexes-opclass">http://www.postgresql.org/docs/8.3/interactive/indexes-opclass</a>.htmlを参照）。 ：class： <cite>.Index`構造体は、</cite> <a href="#id1"><span class="problematic" id="id2">`</span></a>postgresql_ops``キーワード引数で指定することができます:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Index</span><span class="p">(</span>
    <span class="s1">&#39;my_index&#39;</span><span class="p">,</span> <span class="n">my_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">my_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
    <span class="n">postgresql_ops</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;text_pattern_ops&#39;</span><span class="p">,</span>
        <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;int4_ops&#39;</span>
    <span class="p">})</span></pre></div>
</div>
<p>`` postgresql_ops``辞書のキーは：class： <cite>.Column`の&amp;quot;キー&amp;quot;の名前です。つまり、</cite> <a href="#id1"><span class="problematic" id="id2">`</span></a>.c``コレクションからアクセスするための名前です。class： <a href="#id3"><span class="problematic" id="id4">`</span></a>.Table`は、データベースで表現されているカラムの実際の名前とは異なるように設定することができます。</p>
<p>`` postgresql_ops``を関数呼び出しのような複雑なSQL式に対して使用する場合は、カラムに適用するために辞書名で指定されたラベルを与えなければなりません。例えば：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Index</span><span class="p">(</span>
    <span class="s1">&#39;my_index&#39;</span><span class="p">,</span> <span class="n">my_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
    <span class="n">func</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span><span class="n">my_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s1">&#39;data_lower&#39;</span><span class="p">),</span>
    <span class="n">postgresql_ops</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;data_lower&#39;</span><span class="p">:</span> <span class="s1">&#39;text_pattern_ops&#39;</span><span class="p">,</span>
        <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;int4_ops&#39;</span>
    <span class="p">})</span></pre></div>
</div>
</div>
<div class="section" id="index-types">
<h3>インデックスの種類<a class="headerlink" href="#index-types" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>PostgreSQLは、B-Tree、Hash、GiST、GINなどのインデックスタイプと、独自のインデックス作成機能（<a class="reference external" href="http://www.postgresql.org/docs/8.3/static/indexes">http://www.postgresql.org/docs/8.3/static/indexes</a>-typesを参照）を提供しています。 html）。これらは `` postgresql_using``キーワード引数を使ってclass： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Index`で指定することができます:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Index</span><span class="p">(</span><span class="s1">&#39;my_index&#39;</span><span class="p">,</span> <span class="n">my_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">postgresql_using</span><span class="o">=</span><span class="s1">&#39;gin&#39;</span><span class="p">)</span></pre></div>
</div>
<p>キーワード引数に渡された値は、基礎となるCREATE INDEXコマンドに渡されるだけなので、使用しているPostgreSQLのバージョンの有効なインデックスタイプでなければなりません。</p>
</div>
<div class="section" id="index-storage-parameters">
<span id="postgresql-index-storage"></span><h3>索引記憶域パラメータ<a class="headerlink" href="#index-storage-parameters" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>PostgreSQLでは、インデックスにストレージパラメータを設定できます。使用可能なストレージパラメータは、インデックスで使用されるインデックスメソッドによって異なります。記憶域パラメータは、 `` postgresql_with``キーワード引数を使って：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Index`で指定することができます:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Index</span><span class="p">(</span><span class="s1">&#39;my_index&#39;</span><span class="p">,</span> <span class="n">my_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">postgresql_with</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fillfactor&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">})</span></pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.0.6 で追加.</span></p>
</div>
<p>PostgreSQLでは、インデックスを作成するためのテーブルスペースを定義することができます。テーブルスペースは `` postgresql_tablespace``キーワード引数を使って：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Index`で指定することができます:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Index</span><span class="p">(</span><span class="s1">&#39;my_index&#39;</span><span class="p">,</span> <span class="n">my_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">postgresql_tablespace</span><span class="o">=</span><span class="s1">&#39;my_tablespace&#39;</span><span class="p">)</span></pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.1 で追加.</span></p>
</div>
<p>同じオプションがclass： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Table`でも利用可能であることに注意してください。</p>
</div>
<div class="section" id="indexes-with-concurrently">
<span id="postgresql-index-concurrently"></span><h3>CONCURRENTLYのインデックス<a class="headerlink" href="#indexes-with-concurrently" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>PostgreSQLインデックスオプションCONCURRENTLYは、 `` postgresql_concurrently``フラグを：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Index`構造体に渡すことでサポートされています:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tbl</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;testtbl&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">))</span>

<span class="n">idx1</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span><span class="s1">&#39;test_idx1&#39;</span><span class="p">,</span> <span class="n">tbl</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">postgresql_concurrently</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></pre></div>
</div>
<p>上記の索引構成では、PostgreSQL 8.2以降が検出されたと仮定して、CREATE INDEXのDDLをレンダリングします。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">INDEX</span> <span class="n">CONCURRENTLY</span> <span class="n">test_idx1</span> <span class="n">ON</span> <span class="n">testtbl</span> <span class="p">(</span><span class="n">data</span><span class="p">)</span></pre></div>
</div>
<p>DROP INDEXの場合、PostgreSQL 9.2以降が検出された場合、または接続のない方言については、:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DROP</span> <span class="n">INDEX</span> <span class="n">CONCURRENTLY</span> <span class="n">test_idx1</span></pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.1 で追加: </span>DROP INDEXでCONCURRENTLYをサポートしています。 CONCURRENTLYキーワードは、接続でPostgreSQLの十分なバージョンが検出された場合（または接続のない方言の場合）にのみ生成されます。</p>
</div>
<p>CONCURRENTLYを使用する場合、PostgreSQLデータベースでは、トランザクションブロック外でステートメントを呼び出す必要があります。 Python DBAPIは、単一の文であってもトランザクションが存在するので、この構文を使用するためにDBAPIの&amp;quot;autocommit &amp;quot;モードを使用する必要があります:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">metadata</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span>
    <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">))</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span>
    <span class="s2">&quot;foo_idx&quot;</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">postgresql_concurrently</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">conn</span><span class="o">.</span><span class="n">execution_options</span><span class="p">(</span><span class="n">isolation_level</span><span class="o">=</span><span class="s1">&#39;AUTOCOMMIT&#39;</span><span class="p">):</span>
        <span class="n">table</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span></pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">：ref： <cite>postgresql_isolation_level</cite></p>
</div>
</div>
</div>
<div class="section" id="postgresql-index-reflection">
<span id="id1"></span><h2>PostgreSQLインデックスリフレクション<a class="headerlink" href="#postgresql-index-reflection" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>PostgreSQLデータベースは、UNIQUE CONSTRAINT構文が使用されるたびに、UNIQUE INDEXを暗黙的に作成します。 ：meth： <cite>.Inspector.get_indexes`と：meth：</cite> .Inspector.get_unique_constraints`は、class： <cite>.Inspector`を使用してテーブルを検査するとき、これらの2つの構文について明確に報告します。索引の場合、索引項目に制約がミラーリングされていると検出された場合は、キー「duplicates_constraint」が索引項目に表示されます。 `</cite> Table（...、autoload = True） <a href="#id1"><span class="problematic" id="id2">``</span></a>を使用してリフレクションを実行するとき、UNIQUE INDEXはミラーリングとして検出されたときに** attr： <cite>.Table.indexes`で**返されません：class：</cite> .UniqueConstraint`を：attr： <a href="#id3"><span class="problematic" id="id4">`</span></a>.Table.constraints`コレクションに追加しました。</p>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 1.0.0 で変更: </span>- <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> reflection now includes
<a class="reference internal" href="../core/constraints.html#sqlalchemy.schema.UniqueConstraint" title="sqlalchemy.schema.UniqueConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueConstraint</span></code></a> objects present in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Table.constraints</span></code>
collection; the PostgreSQL backend will no longer include a &quot;mirrored&quot;
<a class="reference internal" href="../core/constraints.html#sqlalchemy.schema.Index" title="sqlalchemy.schema.Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code></a> construct in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Table.indexes</span></code> if it is detected
as corresponding to a unique constraint.</p>
</div>
</div>
<div class="section" id="special-reflection-options">
<h2>特殊反射オプション<a class="headerlink" href="#special-reflection-options" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>PostgreSQLバックエンドに使用される：class： <cite>.Inspector`は：class：</cite> .PGInspector`のインスタンスです。これは追加のメソッドを提供します:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="k">import</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">inspect</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql+psycopg2://localhost/test&quot;</span><span class="p">)</span>
<span class="n">insp</span> <span class="o">=</span> <span class="n">inspect</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>  <span class="c1"># will be a PGInspector</span>

<span class="nb">print</span><span class="p">(</span><span class="n">insp</span><span class="o">.</span><span class="n">get_enums</span><span class="p">())</span></pre></div>
</div>
<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.base.PGInspector">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.base.</code><code class="descname">PGInspector</code><span class="sig-paren">(</span><em>conn</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.base.PGInspector" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/reflection.html#sqlalchemy.engine.reflection.Inspector" title="sqlalchemy.engine.reflection.Inspector"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.engine.reflection.Inspector</span></code></a></p>
<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.base.PGInspector.get_enums">
<code class="descname">get_enums</code><span class="sig-paren">(</span><em>schema=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.base.PGInspector.get_enums" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ENUMオブジェクトのリストを返します。</p>
<p>各メンバーは、次のフィールドを含む辞書です。</p>
<blockquote>
<div><ul class="simple">
<li>name  - 列挙型の名前</li>
<li>schema  - 列挙のスキーマ名</li>
<li>visible  - このenumがデフォルトの検索パスに表示されるかどうかを示すブール値</li>
<li>labels  -  enumに適用される文字列ラベルのリスト。</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメータ:</th><td class="field-body"><span class="target" id="sqlalchemy.dialects.postgresql.base.PGInspector.get_enums.params.schema"></span><strong>schema</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.base.PGInspector.get_enums.params.schema">¶</a> -- スキーマ名。 Noneの場合、デフォルトスキーマ（通常は &amp;#39;public&amp;#39;）が使用されます。すべてのスキーマのロード列挙を示すために &amp;#39;*&amp;#39;に設定することもできます。</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.0.0 で追加.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.base.PGInspector.get_foreign_table_names">
<code class="descname">get_foreign_table_names</code><span class="sig-paren">(</span><em>schema=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.base.PGInspector.get_foreign_table_names" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>FOREIGN TABLEの名前のリストを返します。</p>
<p>動作は：meth： <cite>.Inspector.get_table_names`の動作に似ていますが、リストは</cite> <cite>relkind``の</cite> <a href="#id1"><span class="problematic" id="id2">`</span></a>f``値を報告するテーブルに限定されています。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.0.0 で追加.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.base.PGInspector.get_table_oid">
<code class="descname">get_table_oid</code><span class="sig-paren">(</span><em>table_name</em>, <em>schema=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.base.PGInspector.get_table_oid" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>指定されたテーブル名のOIDを返します。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.base.PGInspector.get_view_names">
<code class="descname">get_view_names</code><span class="sig-paren">(</span><em>schema=None</em>, <em>include=('plain'</em>, <em>'materialized')</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.base.PGInspector.get_view_names" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a href="#id1"><span class="problematic" id="id2">`</span></a>schema`の全てのビュー名を返します。</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメータ:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="sqlalchemy.dialects.postgresql.base.PGInspector.get_view_names.params.schema"></span><strong>schema</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.base.PGInspector.get_view_names.params.schema">¶</a> -- オプションで、デフォルト以外のスキーマから名前を取得します。特別な引用のために、：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.quoted_name`を使います。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.base.PGInspector.get_view_names.params.include"></span><strong>include</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.base.PGInspector.get_view_names.params.include">¶</a> -- 戻すビューのタイプを指定します。文字列値（単一の型の場合）またはタプル（任意の数の型の場合）として渡されます。デフォルトは <a href="#id1"><span class="problematic" id="id2">``</span></a>（ &amp;#39;plain&amp;#39;、 &amp;#39;materialized&amp;#39;） <a href="#id3"><span class="problematic" id="id4">``</span></a>です。 .. versionadded :: 1.1</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="postgresql-table-options">
<span id="id2"></span><h2>PostgreSQLのテーブルオプション<a class="headerlink" href="#postgresql-table-options" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>CREATE TABLEのいくつかのオプションは、：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Table`構文と一緒にPostgreSQLの方言によって直接サポートされています：</p>
<ul>
<li><p class="first">`` TABLESPACE``</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span><span class="s2">&quot;some_table&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">postgresql_tablespace</span><span class="o">=</span><span class="s1">&#39;some_tablespace&#39;</span><span class="p">)</span></pre></div>
</div>
<p>上記のオプションは：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Index`構造でも利用できます。</p>
</li>
<li><p class="first">`` ON COMMIT`</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span><span class="s2">&quot;some_table&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">postgresql_on_commit</span><span class="o">=</span><span class="s1">&#39;PRESERVE ROWS&#39;</span><span class="p">)</span></pre></div>
</div>
</li>
<li><p class="first">`` OIDS``</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span><span class="s2">&quot;some_table&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">postgresql_with_oids</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></pre></div>
</div>
</li>
<li><p class="first">`` OIDSなし ``</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span><span class="s2">&quot;some_table&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">postgresql_with_oids</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></pre></div>
</div>
</li>
<li><p class="first">「INHERITS」:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span><span class="s2">&quot;some_table&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">postgresql_inherits</span><span class="o">=</span><span class="s2">&quot;some_supertable&quot;</span><span class="p">)</span>

<span class="n">Table</span><span class="p">(</span><span class="s2">&quot;some_table&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">postgresql_inherits</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;t1&quot;</span><span class="p">,</span> <span class="s2">&quot;t2&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">))</span>

<span class="o">..</span> <span class="n">versionadded</span><span class="p">::</span> <span class="mf">1.0</span><span class="o">.</span><span class="mi">0</span></pre></div>
</div>
</li>
<li><p class="first">`` PARTITION BY``</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span><span class="s2">&quot;some_table&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>
      <span class="n">postgresql_partition_by</span><span class="o">=</span><span class="s1">&#39;LIST (part_column)&#39;</span><span class="p">)</span>

<span class="o">..</span> <span class="n">versionadded</span><span class="p">::</span> <span class="mf">1.2</span><span class="o">.</span><span class="mi">6</span></pre></div>
</div>
</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last"><a href="#id1"><span class="problematic" id="id2">`</span></a>PostgreSQLのCREATE TABLEオプション&lt;<a class="reference external" href="http://www.postgresql.org/docs/current/static/sql-createtable.html">http://www.postgresql.org/docs/current/static/sql-createtable.html</a>&gt; <a href="#id3"><span class="problematic" id="id4">`</span></a>_</p>
</div>
</div>
<div class="section" id="array-types">
<h2>ARRAYタイプ<a class="headerlink" href="#array-types" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>PostgreSQLの方言は、多次元列型と配列リテラルの両方として配列をサポートしています：</p>
<ul class="simple">
<li>：クラス： <cite>.postgresql.ARRAY</cite>  -  ARRAYデータ型</li>
<li>：class： <cite>.postgresql.array</cite>  - 配列リテラル</li>
<li>：func： <cite>.postgresql.array_agg</cite>  -  ARRAY_AGG SQL関数</li>
<li>：class： <cite>.postgresql.aggregate_order_by</cite>  -  PGのORDER BY集約関数構文のヘルパーです。</li>
</ul>
</div>
<div class="section" id="json-types">
<h2>JSONの種類<a class="headerlink" href="#json-types" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>PostgreSQLの方言は、psycopg2のネイティブサポートとPostgreSQLのすべての特別な演算子のサポートを含むJSONとJSONBの両方のデータ型をサポートしています：</p>
<ul class="simple">
<li>：クラス： <cite>.postgresql.JSON</cite></li>
<li>：クラス： <cite>.postgresql.JSONB</cite></li>
</ul>
</div>
<div class="section" id="hstore-type">
<h2>HSTOREタイプ<a class="headerlink" href="#hstore-type" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>PostgreSQL HSTORE型とhstoreリテラルがサポートされています：</p>
<ul class="simple">
<li>：クラス： <cite>.postgresql.HSTORE</cite>  -  HSTOREデータ型</li>
<li>：クラス： <cite>.postgresql.hstore</cite>  -  hstoreリテラル</li>
</ul>
</div>
<div class="section" id="enum-types">
<h2>ENUMの種類<a class="headerlink" href="#enum-types" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>PostgreSQLには、列挙型を実装するために独立して作成可能なTYPE構造体があります。このアプローチは、この型をCREATEDおよびDROPPEDにする必要があるという点で、SQLAlchemyの面でかなりの複雑さをもたらします。型オブジェクトは、独立して反映可能なエンティティでもあります。次のセクションを参照してください。</p>
<ul class="simple">
<li>：class： <cite>.postgresql.ENUM</cite>  -  DDLとENUMのためのタイピングサポート。</li>
<li>：meth： <cite>.PGInspector.get_enums</cite>  - 現在のENUM型のリストを取得する</li>
<li>：meth： <cite>.postgresql.ENUM.create</cite>、：meth：` .postgresql.ENUM.drop`  -  ENUMのための個々のCREATEとDROPコマンド。</li>
</ul>
<div class="section" id="using-enum-with-array">
<span id="postgresql-array-of-enum"></span><h3>ARRAYでのENUMの使用<a class="headerlink" href="#using-enum-with-array" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ENUMとARRAYの組み合わせは、現時点でバックエンドDBAPIによって直接サポートされていません。 ENUMのARRAYを送受信するには、次の対処方法を使用します:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ArrayOfEnum</span><span class="p">(</span><span class="n">ARRAY</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">bind_expression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bindvalue</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sa</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">bindvalue</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">result_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="p">,</span> <span class="n">coltype</span><span class="p">):</span>
        <span class="n">super_rp</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ArrayOfEnum</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">result_processor</span><span class="p">(</span>
            <span class="n">dialect</span><span class="p">,</span> <span class="n">coltype</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">handle_raw_string</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="n">inner</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^{(.*)}$&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">inner</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">inner</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="n">super_rp</span><span class="p">(</span><span class="n">handle_raw_string</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">process</span></pre></div>
</div>
<p>例えば：：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span>
    <span class="s1">&#39;mydata&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">ArrayOfEnum</span><span class="p">(</span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b, &#39;</span><span class="n">c</span><span class="s1">&#39;, name=&#39;</span><span class="n">myenum</span><span class="s1">&#39;)))</span>

<span class="p">)</span></pre></div>
</div>
<p>このタイプは組み込みタイプには含まれていません。新しいバージョンで直接ENRのARRAYをサポートすることを突然決定したDBAPIと互換性がないからです。</p>
</div>
<div class="section" id="using-json-jsonb-with-array">
<span id="postgresql-array-of-json"></span><h3>ARRAYでのJSON / JSONBの使用<a class="headerlink" href="#using-json-jsonb-with-array" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ENUMを使用するのと同様に、JSON / JSONBのARRAYに対して適切なCASTをレンダリングする必要がありますが、現在のpsycopg2ドライバはJSONのARRAYの結果を自動的に処理するように見えるので、タイプはよりシンプルです:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CastingArray</span><span class="p">(</span><span class="n">ARRAY</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">bind_expression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bindvalue</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sa</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">bindvalue</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></pre></div>
</div>
<p>例えば：：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span>
    <span class="s1">&#39;mydata&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">CastingArray</span><span class="p">(</span><span class="n">JSONB</span><span class="p">))</span>
<span class="p">)</span></pre></div>
</div>
</div>
</div>
<div class="section" id="postgresql-data-types">
<h2>PostgreSQLのデータ型<a class="headerlink" href="#postgresql-data-types" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>すべてのSQLAlchemy方言と同様に、PostgreSQLで有効であることが知られているすべてのUPPERCASE型は、from：mod： <a href="#id1"><span class="problematic" id="id2">`</span></a>sqlalchemy.types`またはローカルの方言から上位の方言からインポートできます:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects.postgresql</span> <span class="k">import</span> \
    <span class="n">ARRAY</span><span class="p">,</span> <span class="n">BIGINT</span><span class="p">,</span> <span class="n">BIT</span><span class="p">,</span> <span class="n">BOOLEAN</span><span class="p">,</span> <span class="n">BYTEA</span><span class="p">,</span> <span class="n">CHAR</span><span class="p">,</span> <span class="n">CIDR</span><span class="p">,</span> <span class="n">DATE</span><span class="p">,</span> \
    <span class="n">DOUBLE_PRECISION</span><span class="p">,</span> <span class="n">ENUM</span><span class="p">,</span> <span class="n">FLOAT</span><span class="p">,</span> <span class="n">HSTORE</span><span class="p">,</span> <span class="n">INET</span><span class="p">,</span> <span class="n">INTEGER</span><span class="p">,</span> \
    <span class="n">INTERVAL</span><span class="p">,</span> <span class="n">JSON</span><span class="p">,</span> <span class="n">JSONB</span><span class="p">,</span> <span class="n">MACADDR</span><span class="p">,</span> <span class="n">MONEY</span><span class="p">,</span> <span class="n">NUMERIC</span><span class="p">,</span> <span class="n">OID</span><span class="p">,</span> <span class="n">REAL</span><span class="p">,</span> <span class="n">SMALLINT</span><span class="p">,</span> <span class="n">TEXT</span><span class="p">,</span> \
    <span class="n">TIME</span><span class="p">,</span> <span class="n">TIMESTAMP</span><span class="p">,</span> <span class="n">UUID</span><span class="p">,</span> <span class="n">VARCHAR</span><span class="p">,</span> <span class="n">INT4RANGE</span><span class="p">,</span> <span class="n">INT8RANGE</span><span class="p">,</span> <span class="n">NUMRANGE</span><span class="p">,</span> \
    <span class="n">DATERANGE</span><span class="p">,</span> <span class="n">TSRANGE</span><span class="p">,</span> <span class="n">TSTZRANGE</span><span class="p">,</span> <span class="n">TSVECTOR</span></pre></div>
</div>
<p>PostgreSQLに固有の型、またはPostgreSQL固有の構築引数を持つ型は、次のとおりです。</p>
<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.aggregate_order_by">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">aggregate_order_by</code><span class="sig-paren">(</span><em>target</em>, <em>*order_by</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.aggregate_order_by" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.ColumnElement" title="sqlalchemy.sql.expression.ColumnElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.sql.expression.ColumnElement</span></code></a></p>
<p>PostgreSQL集約オーダーを式で表現します。</p>
<p>例えば：：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects.postgresql</span> <span class="k">import</span> <span class="n">aggregate_order_by</span>
<span class="n">expr</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">array_agg</span><span class="p">(</span><span class="n">aggregate_order_by</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">desc</span><span class="p">()))</span>
<span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">expr</span><span class="p">])</span></pre></div>
</div>
<p>式:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">array_agg</span><span class="p">(</span><span class="n">a</span> <span class="n">ORDER</span> <span class="n">BY</span> <span class="n">b</span> <span class="n">DESC</span><span class="p">)</span> <span class="n">FROM</span> <span class="n">table</span><span class="p">;</span></pre></div>
</div>
<p>同様に:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">expr</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">string_agg</span><span class="p">(</span>
    <span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
    <span class="n">aggregate_order_by</span><span class="p">(</span><span class="n">literal_column</span><span class="p">(</span><span class="s2">&quot;&#39;,&#39;&quot;</span><span class="p">),</span> <span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">expr</span><span class="p">])</span></pre></div>
</div>
<p>dummy literal</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">string_agg</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span> <span class="n">ORDER</span> <span class="n">BY</span> <span class="n">a</span><span class="p">)</span> <span class="n">FROM</span> <span class="n">table</span><span class="p">;</span></pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.1 で追加.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 1.2.13 で変更: </span>- the ORDER BY argument may be multiple terms</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">：クラス： <cite>.array_agg</cite></p>
</div>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.array">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">array</code><span class="sig-paren">(</span><em>clauses</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.array" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.Tuple" title="sqlalchemy.sql.expression.Tuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.sql.expression.Tuple</span></code></a></p>
<p>PostgreSQLのARRAYリテラル。</p>
<p>これは、SQL式でARRAYリテラルを生成するために使用されます。例えば:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects.postgresql</span> <span class="k">import</span> <span class="n">array</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.dialects</span> <span class="k">import</span> <span class="n">postgresql</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="k">import</span> <span class="n">select</span><span class="p">,</span> <span class="n">func</span>

<span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span>
                <span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
            <span class="p">])</span>

<span class="nb">print</span> <span class="n">stmt</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">dialect</span><span class="o">=</span><span class="n">postgresql</span><span class="o">.</span><span class="n">dialect</span><span class="p">())</span></pre></div>
</div>
<p>SQLを生成する:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">ARRAY</span><span class="p">[</span><span class="o">%</span><span class="p">(</span><span class="n">param_1</span><span class="p">)</span><span class="n">s</span><span class="p">,</span> <span class="o">%</span><span class="p">(</span><span class="n">param_2</span><span class="p">)</span><span class="n">s</span><span class="p">]</span> <span class="o">||</span>
    <span class="n">ARRAY</span><span class="p">[</span><span class="o">%</span><span class="p">(</span><span class="n">param_3</span><span class="p">)</span><span class="n">s</span><span class="p">,</span> <span class="o">%</span><span class="p">(</span><span class="n">param_4</span><span class="p">)</span><span class="n">s</span><span class="p">,</span> <span class="o">%</span><span class="p">(</span><span class="n">param_5</span><span class="p">)</span><span class="n">s</span><span class="p">])</span> <span class="n">AS</span> <span class="n">anon_1</span></pre></div>
</div>
<p>：class： <cite>.array`のインスタンスは常にclass：</cite> .ARRAY`というデータ型を持ちます。 `` type_``キーワード引数が渡されない限り、配列の&amp;quot;inner &amp;quot;型は存在する値から推測されます:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">],</span> <span class="n">type_</span><span class="o">=</span><span class="n">CHAR</span><span class="p">)</span></pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">バージョン 0.8 で追加: </span>：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>〜.postgresql.array`リテラル型を追加しました。</p>
</div>
<p>参照：</p>
<p>：クラス： <cite>.postgresql.ARRAY</cite></p>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.ARRAY">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">ARRAY</code><span class="sig-paren">(</span><em>item_type</em>, <em>as_tuple=False</em>, <em>dimensions=None</em>, <em>zero_indexes=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ARRAY" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.ARRAY" title="sqlalchemy.types.ARRAY"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.ARRAY</span></code></a></p>
<p>PostgreSQLのARRAYタイプ。</p>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 1.1 で変更: </span>：class： <cite>.postgresql.ARRAY`型はcore：class：</cite> .types.ARRAY`型のサブクラスになりました。</p>
</div>
<p>：class： <cite>.postgresql.ARRAY`型は、core：class：</cite> .types.ARRAY`型と同じ方法で構築されます。メンバータイプが必要です。複数のディメンションに複数のディメンションを使用する場合は、ディメンション数を推奨します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects</span> <span class="k">import</span> <span class="n">postgresql</span>

<span class="n">mytable</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s2">&quot;mytable&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
        <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">postgresql</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="p">)</span></pre></div>
</div>
<p>：class： <cite>.postgresql.ARRAY`型は、core：class：</cite> .types.ARRAY`型で定義されたすべての操作を提供します。例えば、 &amp;quot;dimensions&amp;quot;、インデックス付きアクセス、 .types.ARRAY.Comparator.any`と：meth： <cite>.types.ARRAY.Comparator.all`です。 ：class： `.postgresql.ARRAY`クラスは、meth：</cite> .postgresql.ARRAY.Comparator.contains`：meth： <cite>.postgresql.ARRAY.Comparator.contained_by`を含む、包含操作のためのPostgreSQL固有のメソッドも提供します： meth： `.postgresql.ARRAY.Comparator.overlap</cite>、例えば:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mytable</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">contains</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span></pre></div>
</div>
<p>：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.postgresql.ARRAY`タイプは、すべてのPostgreSQL DBAPIでサポートされているわけではありません。 psycopg2のみで動作することが現在知られています。</p>
<p>さらに：class： <cite>.postgresql.ARRAY`型は、：class：</cite> .ENUM`型と直接には連動しません。回避策は、ref： <a href="#id1"><span class="problematic" id="id2">`</span></a>postgresql_array_of_enum`の特別な型を参照してください。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p>：class： <cite>.types.ARRAY</cite>  - 基本配列型</p>
<p class="last">：class： <cite>.postgresql.array</cite>  - リテラル配列の値を生成します。</p>
</div>
<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.ARRAY.Comparator">
<em class="property">class </em><code class="descname">Comparator</code><span class="sig-paren">(</span><em>expr</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ARRAY.Comparator" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.Comparator</span></code></p>
<p>：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.ARRAY`の比較演算を定義します。</p>
<p>これらの操作は、base：class： <cite>.types.ARRAY.Comparator`クラスによって提供されるものに加えて、：meth：</cite> .types.ARRAY.Comparator.any`と：meth： <cite>.types.ARRAYを含むことに注意してください。 Comparator.all</cite>。</p>
<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.ARRAY.Comparator.contained_by">
<code class="descname">contained_by</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ARRAY.Comparator.contained_by" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。要素が引数配列式の要素の適切なサブセットであるかどうかをテストします。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.ARRAY.Comparator.contains">
<code class="descname">contains</code><span class="sig-paren">(</span><em>other</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ARRAY.Comparator.contains" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。要素が引数配列式の要素のスーパーセットであるかどうかをテストします。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.ARRAY.Comparator.overlap">
<code class="descname">overlap</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ARRAY.Comparator.overlap" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。配列に引数配列式と共通の要素があるかどうかを調べます。</p>
</dd></dl>

</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.ARRAY.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>item_type</em>, <em>as_tuple=False</em>, <em>dimensions=None</em>, <em>zero_indexes=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ARRAY.__init__" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ARRAYを構築します。</p>
<p>例えば：：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Column</span><span class="p">(</span><span class="s1">&#39;myarray&#39;</span><span class="p">,</span> <span class="n">ARRAY</span><span class="p">(</span><span class="n">Integer</span><span class="p">))</span></pre></div>
</div>
<p>引数は次のとおりです。</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメータ:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="sqlalchemy.dialects.postgresql.ARRAY.params.item_type"></span><strong>item_type</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.ARRAY.params.item_type">¶</a> -- この配列の項目のデータ型。ここで、次元は無関係であるため、 `` INTEGER [] [] <a href="#id1"><span class="problematic" id="id2">``</span></a>のような多次元配列は、 `` ARRAY（ARRAY（Integer）） <a href="#id3"><span class="problematic" id="id4">``</span></a>ではなく、 `` ARRAY（Integer） 。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.ARRAY.params.as_tuple"></span><strong>as_tuple=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.ARRAY.params.as_tuple">¶</a> -- 戻り値をリストからタプルに変換するかどうかを指定します。 psycopg2などのDBAPIでは、デフォルトでリストが返されます。タプルが返されると、結果はハッシュ可能になります。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.ARRAY.params.dimensions"></span><strong>dimensions</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.ARRAY.params.dimensions">¶</a> -- 非なしの場合、ARRAYは固定数の次元を想定します。これにより、このARRAYのために生成されたDDLにブラケット節 `` [] <a href="#id1"><span class="problematic" id="id2">``</span></a>の正確な数が含まれるようになり、全体的な型のパフォーマンスも最適化されます。 PG配列は常に暗黙的に&amp;quot;非次元&amp;quot;であり、宣言された方法に関係なく任意の数の次元を格納できることに注意してください。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.ARRAY.params.zero_indexes"></span><strong>zero_indexes=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.ARRAY.params.zero_indexes">¶</a> -- Trueの場合、インデックス値はPythonのゼロベースとPostgreSQLの1つのインデックスの間で変換されます。例えば、値1はデータベースに渡す前にすべてのインデックス値に追加されます。 .. versionadded :: 0.9.5</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sqlalchemy.dialects.postgresql.array_agg">
<code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">array_agg</code><span class="sig-paren">(</span><em>*arg</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.array_agg" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>PostgreSQL固有の形式のclass： <cite>.array_agg`は、明示的な</cite> <cite>type_``が渡されない限り、戻り値の型は：class：</cite> .postgresql.ARRAY`で、plain：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.types.ARRAY`ではありません。 。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.1 で追加.</span></p>
</div>
</dd></dl>

<dl class="function">
<dt id="sqlalchemy.dialects.postgresql.Any">
<code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">Any</code><span class="sig-paren">(</span><em>other</em>, <em>arrexpr</em>, <em>operator=&lt;built-in function eq&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.Any" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>：meth： <a href="#id1"><span class="problematic" id="id2">`</span></a>.ARRAY.Comparator.any`メソッドの同義語です。</p>
<p>このメソッドは古いもので、後方互換性のためにここにあります。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">：func： <cite>.expression.any_</cite></p>
</div>
</dd></dl>

<dl class="function">
<dt id="sqlalchemy.dialects.postgresql.All">
<code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">All</code><span class="sig-paren">(</span><em>other</em>, <em>arrexpr</em>, <em>operator=&lt;built-in function eq&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.All" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>：meth： <a href="#id1"><span class="problematic" id="id2">`</span></a>.ARRAY.Comparator.all`メソッドの同義語です。</p>
<p>このメソッドは古いもので、後方互換性のためにここにあります。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">：func： <cite>.expression.all_</cite></p>
</div>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.BIT">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">BIT</code><span class="sig-paren">(</span><em>length=None</em>, <em>varying=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.BIT" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.BYTEA">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">BYTEA</code><span class="sig-paren">(</span><em>length=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.BYTEA" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.LargeBinary" title="sqlalchemy.types.LargeBinary"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.LargeBinary</span></code></a></p>
<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.BYTEA.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>length=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.BYTEA.__init__" title="この定義へのパーマリンク">¶</a></dt>
<dd><div class="inherited-member docutils container">
<em>inherited from the</em> <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.LargeBinary.__init__" title="sqlalchemy.types.LargeBinary.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a> <em>method of</em> <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.LargeBinary" title="sqlalchemy.types.LargeBinary"><code class="xref py py-class docutils literal notranslate"><span class="pre">LargeBinary</span></code></a></div>
<p>LargeBinary型を構築します。</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメータ:</th><td class="field-body"><span class="target" id="sqlalchemy.dialects.postgresql.BYTEA.params.length"></span><strong>length</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.BYTEA.params.length">¶</a> -- オプションで、長さを受け入れるバイナリ型（MySQL BLOB型など）のDDL文で使用する列の長さ。</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.CIDR">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">CIDR</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.CIDR" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.DOUBLE_PRECISION">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">DOUBLE_PRECISION</code><span class="sig-paren">(</span><em>precision=None</em>, <em>asdecimal=False</em>, <em>decimal_return_scale=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.DOUBLE_PRECISION" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Float" title="sqlalchemy.types.Float"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.Float</span></code></a></p>
<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.DOUBLE_PRECISION.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>precision=None</em>, <em>asdecimal=False</em>, <em>decimal_return_scale=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.DOUBLE_PRECISION.__init__" title="この定義へのパーマリンク">¶</a></dt>
<dd><div class="inherited-member docutils container">
<em>inherited from the</em> <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Float.__init__" title="sqlalchemy.types.Float.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a> <em>method of</em> <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Float" title="sqlalchemy.types.Float"><code class="xref py py-class docutils literal notranslate"><span class="pre">Float</span></code></a></div>
<p>Floatを構築します。</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメータ:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="sqlalchemy.dialects.postgresql.DOUBLE_PRECISION.params.precision"></span><strong>precision</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.DOUBLE_PRECISION.params.precision">¶</a> -- `` CREATE TABLE`` DDLで使用する数値精度。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.DOUBLE_PRECISION.params.asdecimal"></span><strong>asdecimal</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.DOUBLE_PRECISION.params.asdecimal">¶</a> -- ：class： <cite>.Numeric`と同じフラグですが、デフォルトは</cite> <a href="#id1"><span class="problematic" id="id2">`</span></a>False``です。このフラグを &amp;quot;True&amp;quot;に設定すると、浮動小数点変換が行われることに注意してください。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.DOUBLE_PRECISION.params.decimal_return_scale"></span><strong>decimal_return_scale</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.DOUBLE_PRECISION.params.decimal_return_scale">¶</a> -- 浮動小数点数からPython小数値に変換するときに使用するデフォルトの位取り。浮動小数点の値は、通常、小数の不正確さのために非常に長くなり、ほとんどの浮動小数点データベース型は&amp;quot;スケール&amp;quot;という概念を持たないため、デフォルトで浮動小数点型は変換時に小数点以下10桁を探します。この値を指定すると、その長さがオーバーライドされます。 &amp;quot;scale &amp;quot;を含むMySQLのfloat型は、特に指定がない限り、decimal_return_scaleのデフォルトとして&amp;quot;scale &amp;quot;を使用することに注意してください。 .. versionadded :: 0.9.0</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.DOUBLE_PRECISION.params.**kwargs"></span><strong>**kwargs</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.DOUBLE_PRECISION.params.**kwargs">¶</a> -- 推奨されていません。ここでの追加引数は、デフォルトでは無視されます：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Float`型。追加の引数をサポートするデータベース固有の浮動小数点数については、その方言の詳細については、class： <a href="#id3"><span class="problematic" id="id4">`</span></a>sqlalchemy.dialects.mysql.FLOAT`などのドキュメントを参照してください。</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.ENUM">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">ENUM</code><span class="sig-paren">(</span><em>*enums</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ENUM" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.NativeForEmulated</span></code>, <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Enum" title="sqlalchemy.types.Enum"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.Enum</span></code></a></p>
<p>PostgreSQLのENUMタイプ。</p>
<p>これは：class： <cite>.types.Enum`のサブクラスで、PGの</cite> <cite>CREATE TYPE``と</cite> <a href="#id1"><span class="problematic" id="id2">`</span></a>DROP TYPE``をサポートしています。</p>
<p>組み込みタイプ：class： <cite>.types.Enum`が使用され、：paramref：</cite> .Enum.native_enum`フラグがデフォルトのTrueに設定されている場合、PostgreSQLバックエンドは：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.postgresql.ENUM`を使用します。特定の作成/削除ルールが使用されます。</p>
<p>ENUM型の作成/削除動作は、ENUM型が親テーブルとの関係で厄介な関係にあるため、必然的に複雑です。単一のテーブルによって所有されているか、複数のテーブルで共有されている可能性があります。</p>
<p>：class： <cite>.types.Enum`または：class：</cite> .postgresql.ENUM`を&amp;quot;インライン&amp;quot;形式で使用すると、 `` CREATE TYPE``と `` DROP TYPE``は、 ：meth： <cite>.Table.create`と：meth：</cite> .Table.drop`メソッドは:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;sometable&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;some_enum&#39;</span><span class="p">,</span> <span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;myenum&#39;</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">table</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>  <span class="c1"># will emit CREATE ENUM and CREATE TABLE</span>
<span class="n">table</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>  <span class="c1"># will emit DROP TABLE and DROP ENUM</span></pre></div>
</div>
<p>複数のテーブル間で共通の列挙型を使用するには、：class： <cite>.types.Enum`または：class：</cite> .postgresql.ENUM`を単独で宣言し、それを：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.MetaData`オブジェクト自体:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_enum</span> <span class="o">=</span> <span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;myenum&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>

<span class="n">t1</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;sometable_one&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;some_enum&#39;</span><span class="p">,</span> <span class="n">myenum</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">t2</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;sometable_two&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;some_enum&#39;</span><span class="p">,</span> <span class="n">myenum</span><span class="p">)</span>
<span class="p">)</span></pre></div>
</div>
<p>このパターンを使用する場合、個々のテーブル作成のレベルで注意を払う必要があります。 `` checkfirst = True``を指定せずにCREATE TABLEを発行しても問題は発生します:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t1</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="c1"># will fail: no such type &#39;myenum&#39;</span></pre></div>
</div>
<p>`` checkfirst = True``を指定した場合、個々のテーブルレベルの作成操作は `` ENUM``をチェックし、存在しない場合は作成します:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># will check if enum exists, and emit CREATE TYPE if not</span>
<span class="n">t1</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">checkfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></pre></div>
</div>
<p>メタデータレベルのENUMタイプを使用する場合、メタデータ全体の作成/削除のいずれかが呼び出されると、タイプは常に作成され、削除されます:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>  <span class="c1"># will emit CREATE TYPE</span>
<span class="n">metadata</span><span class="o">.</span><span class="n">drop_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>  <span class="c1"># will emit DROP TYPE</span></pre></div>
</div>
<p>型を直接作成してドロップすることもできます:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_enum</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
<span class="n">my_enum</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span></pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 1.0.0 で変更: </span>PostgreSQL：class： <cite>.postgresql.ENUM`型はCREATE / DROPに関してより厳密に動作するようになりました。メタデータレベルのENUMタイプは、 `</cite> table.create（checkfirst = True） <a href="#id1"><span class="problematic" id="id2">``</span></a>を除いて、テーブルレベルではなく、メタデータレベルでのみ作成され、削除されます。 `` table.drop（） <a href="#id3"><span class="problematic" id="id4">``</span></a>の呼び出しは、テーブルレベルの列挙型に対してDROP TYPEを発行するようになりました。</p>
</div>
<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.ENUM.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>*enums</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ENUM.__init__" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>〜.postgresql.ENUM`を作ります。</p>
<p>引数は：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.types.Enum`の引数と同じですが、以下のパラメータも含みます。</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメータ:</th><td class="field-body"><span class="target" id="sqlalchemy.dialects.postgresql.ENUM.params.create_type"></span><strong>create_type</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.ENUM.params.create_type">¶</a> -- デフォルトはTrueです。親テーブルが作成されているときに、オプションで型の存在をチェックした後に `` CREATE TYPE``を発行する必要があることを示します。 `` DROP TYPE``はテーブルを削除するときに呼び出されます。 `` False``の場合、チェックは行われず、：meth： <cite>〜.postgresql.ENUM.create`または：meth：</cite>〜がなければ、 `` CREATE TYPE``または `` DROP TYPE``は発行されません。 postgresql.ENUM.drop`が直接呼び出されます。 `` False``に設定すると、実際のデータベースにアクセスすることなくSQLスキームの作成スキームを呼び出すときに役立ちます。：meth： <cite>〜.postgresql.ENUM.create`と：meth：</cite>〜.postgresql.ENUM.drop <a href="#id1"><span class="problematic" id="id2">`</span></a>メソッドを使用して、SQLをターゲットバインドに出力することができます。 .. versionadded :: 0.7.4</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.ENUM.create">
<code class="descname">create</code><span class="sig-paren">(</span><em>bind=None</em>, <em>checkfirst=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ENUM.create" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>このために `` CREATE TYPE``を出します：class： <cite>〜.postgresql.ENUM</cite>。</p>
<p>基礎となる方言がPostgreSQLのCREATE TYPEをサポートしていない場合は、何もしません。</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメータ:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="sqlalchemy.dialects.postgresql.ENUM.create.params.bind"></span><strong>bind</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.ENUM.create.params.bind">¶</a> -- connectable：class： <cite>.Engine</cite>、：class：` .Connection`、またはSQLを送出する類似のオブジェクトです。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.ENUM.create.params.checkfirst"></span><strong>checkfirst</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.ENUM.create.params.checkfirst">¶</a> -- `` True``の場合、最初にPGカタログに対するクエリが実行され、型が作成前に既に存在していないかどうかが確認されます。</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.ENUM.drop">
<code class="descname">drop</code><span class="sig-paren">(</span><em>bind=None</em>, <em>checkfirst=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ENUM.drop" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>このために `` DROP TYPE``を出します：class： <cite>〜.postgresql.ENUM</cite>。</p>
<p>基礎となる方言がPostgreSQLのDROP TYPEをサポートしていない場合は、何も行われません。</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメータ:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="sqlalchemy.dialects.postgresql.ENUM.drop.params.bind"></span><strong>bind</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.ENUM.drop.params.bind">¶</a> -- connectable：class： <cite>.Engine</cite>、：class：` .Connection`、またはSQLを送出する類似のオブジェクトです。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.ENUM.drop.params.checkfirst"></span><strong>checkfirst</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.ENUM.drop.params.checkfirst">¶</a> -- `` True``の場合、最初にPGカタログに対するクエリが実行され、型が実際に存在するかどうかを確認します。</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.HSTORE">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">HSTORE</code><span class="sig-paren">(</span><em>text_type=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.HSTORE" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.Indexable" title="sqlalchemy.types.Indexable"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.Indexable</span></code></a>, <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.Concatenable" title="sqlalchemy.types.Concatenable"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.Concatenable</span></code></a>, <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a></p>
<p>PostgreSQLのHSTOREタイプを表します。</p>
<p>：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.HSTORE`型は文字列を含む辞書を格納します::例えば:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;data_table&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">HSTORE</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="n">data_table</span><span class="o">.</span><span class="n">insert</span><span class="p">(),</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;key1&quot;</span><span class="p">:</span> <span class="s2">&quot;value1&quot;</span><span class="p">,</span> <span class="s2">&quot;key2&quot;</span><span class="p">:</span> <span class="s2">&quot;value2&quot;</span><span class="p">}</span>
    <span class="p">)</span></pre></div>
</div>
<p>：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.HSTORE`は以下を含む幅広い操作を提供します：</p>
<ul>
<li><p class="first">索引操作:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;some key&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;some value&#39;</span></pre></div>
</div>
</li>
<li><p class="first">封じ込め操作:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s1">&#39;some key&#39;</span><span class="p">)</span>

<span class="n">data_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">has_all</span><span class="p">([</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">])</span></pre></div>
</div>
</li>
<li><p class="first">連結：：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="p">{</span><span class="s2">&quot;k1&quot;</span><span class="p">:</span> <span class="s2">&quot;v1&quot;</span><span class="p">}</span></pre></div>
</div>
</li>
</ul>
<p>特別なメソッドの完全なリストについては、class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.HSTORE.comparator_factory`を参照してください。</p>
<p>SQLAlchemy ORMを使用するには：class： <cite>.HSTORE`と：class：</cite> .MutableDict`ディクショナリを：mod： <a href="#id1"><span class="problematic" id="id2">`</span></a>sqlalchemy.ext.mutable`拡張の一部として組み合わせることが望ましいかもしれません。この拡張機能は辞書に&amp;quot;インプレース&amp;quot;を変更することができます。例えば、新しいキーの追加や、現在の辞書との既存のキーの置換/削除などは、作業単位で検出されるイベントを生成します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.ext.mutable</span> <span class="k">import</span> <span class="n">MutableDict</span>

<span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&#39;data_table&#39;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">MutableDict</span><span class="o">.</span><span class="n">as_mutable</span><span class="p">(</span><span class="n">HSTORE</span><span class="p">))</span>

<span class="n">my_object</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">MyClass</span><span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>

<span class="c1"># in-place mutation, requires Mutable extension</span>
<span class="c1"># in order for the ORM to detect</span>
<span class="n">my_object</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;some_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;some value&#39;</span>

<span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span></pre></div>
</div>
<p>：mod： <a href="#id1"><span class="problematic" id="id2">`</span></a>sqlalchemy.ext.mutable`拡張が使用されていない場合、その辞書値がHSTORE属性自体に再割り当てされない限り、ORMは既存の辞書の内容の変更に警告されません。変更イベントを生成する。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 0.8 で追加.</span></p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">：class： <cite>.hstore</cite>  -  PostgreSQLの` <cite>hstore（）</cite> <a href="#id1"><span class="problematic" id="id2">`</span></a>関数をレンダリングします。</p>
</div>
<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.HSTORE.Comparator">
<em class="property">class </em><code class="descname">Comparator</code><span class="sig-paren">(</span><em>expr</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.HSTORE.Comparator" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.Comparator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.Comparator</span></code></p>
<p>：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.HSTORE`の比較演算を定義します。</p>
<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.HSTORE.Comparator.array">
<code class="descname">array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.HSTORE.Comparator.array" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>テキスト配列式。交互のキーと値の配列を返します。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.HSTORE.Comparator.contained_by">
<code class="descname">contained_by</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.HSTORE.Comparator.contained_by" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。キーが引数jsonb式のキーの適切なサブセットであるかどうかをテストします。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.HSTORE.Comparator.contains">
<code class="descname">contains</code><span class="sig-paren">(</span><em>other</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.HSTORE.Comparator.contains" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。キー（または配列）が引数jsonb式のスーパーセット/キーを含むかどうかをテストします。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.HSTORE.Comparator.defined">
<code class="descname">defined</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.HSTORE.Comparator.defined" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。キーのNULL以外の値が存在するかどうかをテストします。キーはSQLA式でもよいことに注意してください。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.HSTORE.Comparator.delete">
<code class="descname">delete</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.HSTORE.Comparator.delete" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>HStore式。指定されたキーを削除してこのhstoreの内容を返します。キーはSQLA式でもよいことに注意してください。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.HSTORE.Comparator.has_all">
<code class="descname">has_all</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.HSTORE.Comparator.has_all" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。 jsonbのすべての鍵の存在をテストする</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.HSTORE.Comparator.has_any">
<code class="descname">has_any</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.HSTORE.Comparator.has_any" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。 jsonbでのキーの有無のテスト</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.HSTORE.Comparator.has_key">
<code class="descname">has_key</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.HSTORE.Comparator.has_key" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。キーの存在をテストします。キーはSQLA式でもよいことに注意してください。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.HSTORE.Comparator.keys">
<code class="descname">keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.HSTORE.Comparator.keys" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>テキスト配列式。キーの配列を返します。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.HSTORE.Comparator.matrix">
<code class="descname">matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.HSTORE.Comparator.matrix" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>テキスト配列式。 [key、value]のペアの配列を返します。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.HSTORE.Comparator.slice">
<code class="descname">slice</code><span class="sig-paren">(</span><em>array</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.HSTORE.Comparator.slice" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>HStore式。キーの配列で定義されたhstoreのサブセットを返します。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.HSTORE.Comparator.vals">
<code class="descname">vals</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.HSTORE.Comparator.vals" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>テキスト配列式。値の配列を返します。</p>
</dd></dl>

</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.HSTORE.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>text_type=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.HSTORE.__init__" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Construct a new <a class="reference internal" href="#sqlalchemy.dialects.postgresql.HSTORE" title="sqlalchemy.dialects.postgresql.HSTORE"><code class="xref py py-class docutils literal notranslate"><span class="pre">HSTORE</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメータ:</th><td class="field-body"><span class="target" id="sqlalchemy.dialects.postgresql.HSTORE.params.text_type"></span><strong>text_type</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.HSTORE.params.text_type">¶</a> -- <p>the type that should be used for indexed values.
Defaults to <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Text" title="sqlalchemy.types.Text"><code class="xref py py-class docutils literal notranslate"><span class="pre">types.Text</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.1.0 で追加.</span></p>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.HSTORE.bind_processor">
<code class="descname">bind_processor</code><span class="sig-paren">(</span><em>dialect</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.HSTORE.bind_processor" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Return a conversion function for processing bind values.</p>
<p>Returns a callable which will receive a bind parameter value
as the sole positional argument and will return a value to
send to the DB-API.</p>
<p>If processing is not necessary, the method should return <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメータ:</th><td class="field-body"><span class="target" id="sqlalchemy.dialects.postgresql.HSTORE.bind_processor.params.dialect"></span><strong>dialect</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.HSTORE.bind_processor.params.dialect">¶</a> -- Dialect instance in use.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="sqlalchemy.dialects.postgresql.HSTORE.comparator_factory">
<code class="descname">comparator_factory</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.HSTORE.comparator_factory" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#sqlalchemy.dialects.postgresql.HSTORE.Comparator" title="sqlalchemy.dialects.postgresql.HSTORE.Comparator"><code class="xref py py-class docutils literal notranslate"><span class="pre">HSTORE.Comparator</span></code></a> のエイリアス</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.HSTORE.result_processor">
<code class="descname">result_processor</code><span class="sig-paren">(</span><em>dialect</em>, <em>coltype</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.HSTORE.result_processor" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Return a conversion function for processing result row values.</p>
<p>Returns a callable which will receive a result row column
value as the sole positional argument and will return a value
to return to the user.</p>
<p>If processing is not necessary, the method should return <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメータ:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="sqlalchemy.dialects.postgresql.HSTORE.result_processor.params.dialect"></span><strong>dialect</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.HSTORE.result_processor.params.dialect">¶</a> -- Dialect instance in use.</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.HSTORE.result_processor.params.coltype"></span><strong>coltype</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.HSTORE.result_processor.params.coltype">¶</a> -- DBAPI coltype argument received in cursor.description.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.hstore">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">hstore</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.hstore" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/functions.html#sqlalchemy.sql.functions.GenericFunction" title="sqlalchemy.sql.functions.GenericFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.sql.functions.GenericFunction</span></code></a></p>
<p>PostgreSQLの `` hstore（） <a href="#id1"><span class="problematic" id="id2">``</span></a>関数を使用して、SQL式内でhstore値を構築します。</p>
<p>：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.hstore`関数は、PostgreSQLのドキュメントで説明されているように、1つまたは2つの引数を受け取ります。</p>
<p>例えば：：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects.postgresql</span> <span class="k">import</span> <span class="n">array</span><span class="p">,</span> <span class="n">hstore</span>

<span class="n">select</span><span class="p">([</span><span class="n">hstore</span><span class="p">(</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;value1&#39;</span><span class="p">)])</span>

<span class="n">select</span><span class="p">([</span>
        <span class="n">hstore</span><span class="p">(</span>
            <span class="n">array</span><span class="p">([</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">,</span> <span class="s1">&#39;key3&#39;</span><span class="p">]),</span>
            <span class="n">array</span><span class="p">([</span><span class="s1">&#39;value1&#39;</span><span class="p">,</span> <span class="s1">&#39;value2&#39;</span><span class="p">,</span> <span class="s1">&#39;value3&#39;</span><span class="p">])</span>
        <span class="p">)</span>
    <span class="p">])</span></pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">バージョン 0.8 で追加.</span></p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">：class： <cite>.HSTORE</cite>  -  PostgreSQLの` <a href="#id1"><span class="problematic" id="id2">`</span></a>HSTORE``データ型です。</p>
</div>
<dl class="attribute">
<dt id="sqlalchemy.dialects.postgresql.hstore.type">
<code class="descname">type</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.hstore.type" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#sqlalchemy.dialects.postgresql.HSTORE" title="sqlalchemy.dialects.postgresql.HSTORE"><code class="xref py py-class docutils literal notranslate"><span class="pre">HSTORE</span></code></a> のエイリアス</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.INET">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">INET</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.INET" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.INTERVAL">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">INTERVAL</code><span class="sig-paren">(</span><em>precision=None</em>, <em>fields=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.INTERVAL" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.NativeForEmulated</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types._AbstractInterval</span></code></p>
<p>PostgreSQL INTERVAL型。</p>
<p>INTERVAL型は、すべてのDBAPIでサポートされているわけではありません。 psycopg2では動作し、pg8000やzxjdbcでは動作しないことが知られています。</p>
<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.INTERVAL.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>precision=None</em>, <em>fields=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.INTERVAL.__init__" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>INTERVALを構築します。</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメータ:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="sqlalchemy.dialects.postgresql.INTERVAL.params.precision"></span><strong>precision</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.INTERVAL.params.precision">¶</a> -- オプションの整数精度値</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.INTERVAL.params.fields"></span><strong>fields</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.INTERVAL.params.fields">¶</a> -- 文字列フィールド指定子。 YEAR &amp;quot;、&amp;quot; &amp;quot;MONTH &amp;quot;、 &amp;quot;&amp;quot; &amp;quot;DAY TO HOUR &amp;quot; <a href="#id1"><span class="problematic" id="id2">``</span></a>など、フィールドの格納を制限することができます。versionadded :: 1.2</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.JSON">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">JSON</code><span class="sig-paren">(</span><em>none_as_null=False</em>, <em>astext_type=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.JSON" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON" title="sqlalchemy.types.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.JSON</span></code></a></p>
<p>PostgreSQLのJSONタイプを表します。</p>
<p>このタイプは、Core-level：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.types.JSON`タイプの特殊化です。 NULL値とORMの使用法に関する重要なヒントについては、class： <a href="#id3"><span class="problematic" id="id4">`</span></a>.types.JSON`のドキュメントを必ず読んでください。</p>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 1.1 で変更: </span>：class： <cite>.postgresql.JSON`はPostgreSQLに特化したnew：class：</cite> .types.JSON`型になりました。</p>
</div>
<p>PostgreSQLバージョン：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.JSON`によって提供される演算子は次のものを含みます：</p>
<ul>
<li><p class="first">インデックス操作（ ``  - &amp;gt; <a href="#id1"><span class="problematic" id="id2">``</span></a>演算子）:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;some key&#39;</span><span class="p">]</span>

<span class="n">data_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span></pre></div>
</div>
</li>
<li><p class="first">テキストを返すインデックス演算（ ``  -  &amp;gt;&amp;gt; <a href="#id1"><span class="problematic" id="id2">``</span></a>演算子）:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;some key&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astext</span> <span class="o">==</span> <span class="s1">&#39;some value&#39;</span></pre></div>
</div>
</li>
<li><p class="first">CASTによる索引演算（ &amp;quot;CAST（col  -  &amp;gt;&amp;gt; [some key &amp;#39;] ASと同じです&lt;type&gt; ） <a href="#id1"><span class="problematic" id="id2">``</span></a>）:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;some key&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astext</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">Integer</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span></pre></div>
</div>
</li>
<li><p class="first">パスインデックス操作（ <a href="#id1"><span class="problematic" id="id2">``</span></a>＃&amp;gt; <a href="#id3"><span class="problematic" id="id4">``</span></a>演算子）:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">[(</span><span class="s1">&#39;key_1&#39;</span><span class="p">,</span> <span class="s1">&#39;key_2&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s1">&#39;key_n&#39;</span><span class="p">)]</span></pre></div>
</div>
</li>
<li><p class="first">テキストを返すパスインデックス操作（ <a href="#id1"><span class="problematic" id="id2">``</span></a>＃&amp;gt;&amp;gt; <a href="#id3"><span class="problematic" id="id4">``</span></a>演算子）:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">[(</span><span class="s1">&#39;key_1&#39;</span><span class="p">,</span> <span class="s1">&#39;key_2&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s1">&#39;key_n&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">astext</span> <span class="o">==</span> <span class="s1">&#39;some value&#39;</span></pre></div>
</div>
</li>
</ul>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 1.1 で変更: </span>JSONオブジェクトの：meth： <cite>.ColumnElement.cast`演算子は、キャストがテキスト文字列からしか動作しない場合、：attr：</cite> .JSON.Comparator.astext`修飾子を明示的に呼び出す必要があります。</p>
</div>
<p>インデックス操作は、デフォルトでtypeが：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.JSON`に設定されている式オブジェクトを返します。これにより、JSON指向のさらなる命令が結果タイプに対して呼び出されるようになります。</p>
<p>カスタムシリアライザとデシリアライザは、func： <a href="#id1"><span class="problematic" id="id2">`</span></a>.create_engine`を使用して、方言レベルで指定されます。この理由は、psycopg2を使用する場合、DBAPIはシリアライザをカーソル単位または接続単位でのみ許可するためです。例えば：：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql://scott:tiger@localhost/test&quot;</span><span class="p">,</span>
                        <span class="n">json_serializer</span><span class="o">=</span><span class="n">my_serialize_fn</span><span class="p">,</span>
                        <span class="n">json_deserializer</span><span class="o">=</span><span class="n">my_deserialize_fn</span>
                <span class="p">)</span></pre></div>
</div>
<p>psycopg2方言を使用する場合、json_deserializerは `` psycopg2.extras.register_default_json``を使用してデータベースに対して登録されます。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p>：class： <cite>.types.JSON</cite>  - コアレベルのJSON型</p>
<p class="last">：クラス： <cite>.JSONB</cite></p>
</div>
<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.JSON.Comparator">
<em class="property">class </em><code class="descname">Comparator</code><span class="sig-paren">(</span><em>expr</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.JSON.Comparator" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.Comparator</span></code></p>
<p>：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.JSON`の比較演算を定義します。</p>
<dl class="attribute">
<dt id="sqlalchemy.dialects.postgresql.JSON.Comparator.astext">
<code class="descname">astext</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.JSON.Comparator.astext" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>インデックス付きの式では、SQLでレンダリングするときに&amp;quot;astext &amp;quot;（たとえば&amp;quot; -  &amp;gt;&amp;gt; &amp;quot;）変換を使用します。</p>
<p>例えば：：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span><span class="p">([</span><span class="n">data_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;some key&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astext</span><span class="p">])</span></pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">：meth： <cite>.ColumnElement.cast</cite></p>
</div>
</dd></dl>

</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.JSON.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>none_as_null=False</em>, <em>astext_type=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.JSON.__init__" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Construct a <a class="reference internal" href="#sqlalchemy.dialects.postgresql.JSON" title="sqlalchemy.dialects.postgresql.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSON</span></code></a> type.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメータ:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="sqlalchemy.dialects.postgresql.JSON.params.none_as_null"></span><strong>none_as_null</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.JSON.params.none_as_null">¶</a> -- <p>if True, persist the value <code class="docutils literal notranslate"><span class="pre">None</span></code> as a
SQL NULL value, not the JSON encoding of <code class="docutils literal notranslate"><span class="pre">null</span></code>.   Note that
when this flag is False, the <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.null" title="sqlalchemy.sql.expression.null"><code class="xref py py-func docutils literal notranslate"><span class="pre">null()</span></code></a> construct can still
be used to persist a NULL value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="k">import</span> <span class="n">null</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">insert</span><span class="p">(),</span> <span class="n">data</span><span class="o">=</span><span class="n">null</span><span class="p">())</span></pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 0.9.8 で変更: </span>- Added <code class="docutils literal notranslate"><span class="pre">none_as_null</span></code>, and <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.null" title="sqlalchemy.sql.expression.null"><code class="xref py py-func docutils literal notranslate"><span class="pre">null()</span></code></a>
is now supported in order to persist a NULL value.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last"><a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON.NULL" title="sqlalchemy.types.JSON.NULL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">JSON.NULL</span></code></a></p>
</div>
</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.JSON.params.astext_type"></span><strong>astext_type</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.JSON.params.astext_type">¶</a> -- <p>the type to use for the
<a class="reference internal" href="#sqlalchemy.dialects.postgresql.JSON.Comparator.astext" title="sqlalchemy.dialects.postgresql.JSON.Comparator.astext"><code class="xref py py-attr docutils literal notranslate"><span class="pre">JSON.Comparator.astext</span></code></a>
accessor on indexed attributes.  Defaults to <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Text" title="sqlalchemy.types.Text"><code class="xref py py-class docutils literal notranslate"><span class="pre">types.Text</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.1 で追加.</span></p>
</div>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="sqlalchemy.dialects.postgresql.JSON.comparator_factory">
<code class="descname">comparator_factory</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.JSON.comparator_factory" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#sqlalchemy.dialects.postgresql.JSON.Comparator" title="sqlalchemy.dialects.postgresql.JSON.Comparator"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSON.Comparator</span></code></a> のエイリアス</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.JSONB">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">JSONB</code><span class="sig-paren">(</span><em>none_as_null=False</em>, <em>astext_type=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.JSONB" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.postgresql.json.JSON</span></code></p>
<p>PostgreSQL JSONBタイプを表します。</p>
<p>：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.JSONB`型は任意のJSONB形式のデータを格納します:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;data_table&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">JSONB</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="n">data_table</span><span class="o">.</span><span class="n">insert</span><span class="p">(),</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;key1&quot;</span><span class="p">:</span> <span class="s2">&quot;value1&quot;</span><span class="p">,</span> <span class="s2">&quot;key2&quot;</span><span class="p">:</span> <span class="s2">&quot;value2&quot;</span><span class="p">}</span>
    <span class="p">)</span></pre></div>
</div>
<p>：class： <cite>.JSONB`型は：class：</cite> .JSON`によって提供されるすべての操作を含みます。これには、インデックス操作と同じ動作が含まれます。また、：meth： <cite>.JSONB.Comparator.has_key</cite>、：meth：` .JSONB.Comparator.has_all`、：meth： <cite>.JSONB.Comparator.has_any</cite>、：meth：` JSONB.Comparator.has_any`を含むJSONBに固有の演算子を追加します。 .JSONB.Comparator.contains`、および：meth： <cite>.JSONB.Comparator.contained_by</cite>。</p>
<p>：class： <cite>.JSON`型と同じように、：class：</cite> .JSONB`型は、：mod： <a href="#id1"><span class="problematic" id="id2">`</span></a>sqlalchemy.ext.mutable`拡張が使われていない限り、ORMとともに使用されたときのインプレースの変更を検出しません。</p>
<p>カスタム・シリアライザとデシリアライザは：class： <cite>.JSON`クラスと共有され、</cite> <cite>json_serializer``と</cite> <cite>json_deserializer``キーワード引数を使用します。これらは、func： `.create_engine`を使って方言レベルで指定する必要があります。 psycopg2を使用する場合、シリアライザは、 `</cite> psycopg2.extras.register_default_json``を使用してこれらのハンドラを登録するのと同じ方法で、接続ごとに `` psycopg2.extras.register_default_jsonb``を使用してjsonbタイプに関連付けられますjsonタイプ。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 0.9.7 で追加.</span></p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">：クラス： <cite>.JSON</cite></p>
</div>
<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.JSONB.Comparator">
<em class="property">class </em><code class="descname">Comparator</code><span class="sig-paren">(</span><em>expr</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.JSONB.Comparator" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.postgresql.json.Comparator</span></code></p>
<p>：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.JSON`の比較演算を定義します。</p>
<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.JSONB.Comparator.contained_by">
<code class="descname">contained_by</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.JSONB.Comparator.contained_by" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。キーが引数jsonb式のキーの適切なサブセットであるかどうかをテストします。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.JSONB.Comparator.contains">
<code class="descname">contains</code><span class="sig-paren">(</span><em>other</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.JSONB.Comparator.contains" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。キー（または配列）が引数jsonb式のスーパーセット/キーを含むかどうかをテストします。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.JSONB.Comparator.has_all">
<code class="descname">has_all</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.JSONB.Comparator.has_all" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。 jsonbのすべての鍵の存在をテストする</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.JSONB.Comparator.has_any">
<code class="descname">has_any</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.JSONB.Comparator.has_any" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。 jsonbでのキーの有無のテスト</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.JSONB.Comparator.has_key">
<code class="descname">has_key</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.JSONB.Comparator.has_key" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。キーの存在をテストします。キーはSQLA式でもよいことに注意してください。</p>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="sqlalchemy.dialects.postgresql.JSONB.comparator_factory">
<code class="descname">comparator_factory</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.JSONB.comparator_factory" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#sqlalchemy.dialects.postgresql.JSONB.Comparator" title="sqlalchemy.dialects.postgresql.JSONB.Comparator"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSONB.Comparator</span></code></a> のエイリアス</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.MACADDR">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">MACADDR</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.MACADDR" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.MONEY">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">MONEY</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.MONEY" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a></p>
<p>PostgreSQL MONEYタイプを指定します。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.2 で追加.</span></p>
</div>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.OID">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">OID</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.OID" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a></p>
<p>PostgreSQLのOIDタイプを指定します。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 0.9.5 で追加.</span></p>
</div>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.REAL">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">REAL</code><span class="sig-paren">(</span><em>precision=None</em>, <em>asdecimal=False</em>, <em>decimal_return_scale=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.REAL" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Float" title="sqlalchemy.types.Float"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.Float</span></code></a></p>
<p>SQL REAL型。</p>
<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.REAL.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>precision=None</em>, <em>asdecimal=False</em>, <em>decimal_return_scale=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.REAL.__init__" title="この定義へのパーマリンク">¶</a></dt>
<dd><div class="inherited-member docutils container">
<em>inherited from the</em> <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Float.__init__" title="sqlalchemy.types.Float.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a> <em>method of</em> <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Float" title="sqlalchemy.types.Float"><code class="xref py py-class docutils literal notranslate"><span class="pre">Float</span></code></a></div>
<p>Floatを構築します。</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメータ:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="sqlalchemy.dialects.postgresql.REAL.params.precision"></span><strong>precision</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.REAL.params.precision">¶</a> -- `` CREATE TABLE`` DDLで使用する数値精度。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.REAL.params.asdecimal"></span><strong>asdecimal</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.REAL.params.asdecimal">¶</a> -- ：class： <cite>.Numeric`と同じフラグですが、デフォルトは</cite> <a href="#id1"><span class="problematic" id="id2">`</span></a>False``です。このフラグを &amp;quot;True&amp;quot;に設定すると、浮動小数点変換が行われることに注意してください。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.REAL.params.decimal_return_scale"></span><strong>decimal_return_scale</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.REAL.params.decimal_return_scale">¶</a> -- 浮動小数点数からPython小数値に変換するときに使用するデフォルトの位取り。浮動小数点の値は、通常、小数の不正確さのために非常に長くなり、ほとんどの浮動小数点データベース型は&amp;quot;スケール&amp;quot;という概念を持たないため、デフォルトで浮動小数点型は変換時に小数点以下10桁を探します。この値を指定すると、その長さがオーバーライドされます。 &amp;quot;scale &amp;quot;を含むMySQLのfloat型は、特に指定がない限り、decimal_return_scaleのデフォルトとして&amp;quot;scale &amp;quot;を使用することに注意してください。 .. versionadded :: 0.9.0</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.REAL.params.**kwargs"></span><strong>**kwargs</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.REAL.params.**kwargs">¶</a> -- 推奨されていません。ここでの追加引数は、デフォルトでは無視されます：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Float`型。追加の引数をサポートするデータベース固有の浮動小数点数については、その方言の詳細については、class： <a href="#id3"><span class="problematic" id="id4">`</span></a>sqlalchemy.dialects.mysql.FLOAT`などのドキュメントを参照してください。</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.REGCLASS">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">REGCLASS</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.REGCLASS" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a></p>
<p>PostgreSQLのREGCLASS型を提供します。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.2.7 で追加.</span></p>
</div>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.TSVECTOR">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">TSVECTOR</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.TSVECTOR" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a></p>
<p>：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.postgresql.TSVECTOR`型はPostgreSQLのテキスト検索型TSVECTORを実装しています。</p>
<p>これは、自然言語文書の全文検索に使用できます。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 0.9.0 で追加.</span></p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">：ref： <cite>postgresql_match</cite></p>
</div>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.UUID">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">UUID</code><span class="sig-paren">(</span><em>as_uuid=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.UUID" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a></p>
<p>PostgreSQLのUUIDタイプ。</p>
<p>データをDBAPIによってネイティブに返されるか、Pythonのuuidオブジェクトとして解釈するUUID列型を表します。</p>
<p>UUIDタイプは、すべてのDBAPIでサポートされているわけではありません。 psycopg2ではなくpg8000で動作することが知られています。</p>
<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.UUID.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>as_uuid=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.UUID.__init__" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>UUID型を構築します。</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメータ:</th><td class="field-body"><span class="target" id="sqlalchemy.dialects.postgresql.UUID.params.as_uuid"></span><strong>as_uuid=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.UUID.params.as_uuid">¶</a> -- Trueの場合、値はPython Uuidオブジェクトとして解釈され、DBAPIを介してstringに/から変換されます。</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<div class="section" id="range-types">
<h3>範囲タイプ<a class="headerlink" href="#range-types" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>PostgreSQL 9.2以降の新しい範囲の列型は、以下の型によって処理されます。</p>
<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.INT4RANGE">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">INT4RANGE</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.INT4RANGE" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sqlalchemy.dialects.postgresql.ranges.RangeOperators" title="sqlalchemy.dialects.postgresql.ranges.RangeOperators"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.postgresql.ranges.RangeOperators</span></code></a>, <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a></p>
<p>PostgreSQLのINT4RANGEタイプを表します。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 0.8.2 で追加.</span></p>
</div>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.INT8RANGE">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">INT8RANGE</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.INT8RANGE" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sqlalchemy.dialects.postgresql.ranges.RangeOperators" title="sqlalchemy.dialects.postgresql.ranges.RangeOperators"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.postgresql.ranges.RangeOperators</span></code></a>, <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a></p>
<p>PostgreSQLのINT8RANGEタイプを表します。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 0.8.2 で追加.</span></p>
</div>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.NUMRANGE">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">NUMRANGE</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.NUMRANGE" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sqlalchemy.dialects.postgresql.ranges.RangeOperators" title="sqlalchemy.dialects.postgresql.ranges.RangeOperators"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.postgresql.ranges.RangeOperators</span></code></a>, <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a></p>
<p>PostgreSQLのNUMRANGE型を表します。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 0.8.2 で追加.</span></p>
</div>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.DATERANGE">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">DATERANGE</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.DATERANGE" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sqlalchemy.dialects.postgresql.ranges.RangeOperators" title="sqlalchemy.dialects.postgresql.ranges.RangeOperators"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.postgresql.ranges.RangeOperators</span></code></a>, <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a></p>
<p>PostgreSQLのDATERANGEタイプを表します。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 0.8.2 で追加.</span></p>
</div>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.TSRANGE">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">TSRANGE</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.TSRANGE" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sqlalchemy.dialects.postgresql.ranges.RangeOperators" title="sqlalchemy.dialects.postgresql.ranges.RangeOperators"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.postgresql.ranges.RangeOperators</span></code></a>, <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a></p>
<p>PostgreSQLのTSRANGEタイプを表します。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 0.8.2 で追加.</span></p>
</div>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.TSTZRANGE">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">TSTZRANGE</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.TSTZRANGE" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sqlalchemy.dialects.postgresql.ranges.RangeOperators" title="sqlalchemy.dialects.postgresql.ranges.RangeOperators"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.postgresql.ranges.RangeOperators</span></code></a>, <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a></p>
<p>PostgreSQLのTSTZRANGEタイプを表します。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 0.8.2 で追加.</span></p>
</div>
</dd></dl>

<p>上記のタイプは、以下のミックスインから機能のほとんどを得ています：</p>
<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.ranges.RangeOperators">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.ranges.</code><code class="descname">RangeOperators</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ranges.RangeOperators" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>このミックスインは、Range FunctionとOperatorsの <cite>postgres documentation`の表9-44にリストされているRange Operatorsの機能を提供します。 `</cite> postgres``の方言で提供されている全ての範囲型で使われており、自分で作成した任意の範囲の型に使うことができます。</p>
<p>Postgresのドキュメントの表9-45に列挙されているRange関数には、特別なサポートは提供されていません。これらのために、normal：func： <a href="#id1"><span class="problematic" id="id2">`</span></a>〜sqlalchemy.sql.expression.func`オブジェクトを使用する必要があります。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 0.8.2 で追加: </span>PostgreSQL RANGE操作のサポート</p>
</div>
<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory">
<em class="property">class </em><code class="descname">comparator_factory</code><span class="sig-paren">(</span><em>expr</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.Comparator</span></code></p>
<p>範囲タイプの比較操作を定義します。</p>
<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory.__ne__">
<code class="descname">__ne__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory.__ne__" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Boolean expression. Returns true if two ranges are not equal</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory.adjacent_to">
<code class="descname">adjacent_to</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory.adjacent_to" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。列の範囲がオペランドの範囲に隣接する場合はtrueを返します。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory.contained_by">
<code class="descname">contained_by</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory.contained_by" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。列が右側のオペランドに含まれている場合はtrueを返します。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory.contains">
<code class="descname">contains</code><span class="sig-paren">(</span><em>other</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory.contains" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。要素または範囲である右手オペランドが列内に含まれている場合はtrueを返します。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory.not_extend_left_of">
<code class="descname">not_extend_left_of</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory.not_extend_left_of" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。列の範囲がオペランドの範囲の左に広がっていない場合はtrueを返します。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory.not_extend_right_of">
<code class="descname">not_extend_right_of</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory.not_extend_right_of" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。列の範囲がオペランドの範囲の右に拡張されない場合はtrueを返します。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory.overlaps">
<code class="descname">overlaps</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory.overlaps" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。列が右手オペランドと重なっている（共通点を持つ）場合はtrueを返します。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory.strictly_left_of">
<code class="descname">strictly_left_of</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory.strictly_left_of" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。列が厳密に右端のオペランドの左にある場合はtrueを返します。</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory.strictly_right_of">
<code class="descname">strictly_right_of</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ranges.RangeOperators.comparator_factory.strictly_right_of" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ブール式。列が厳密に右辺のオペランドの右にある場合はtrueを返します。</p>
</dd></dl>

</dd></dl>

</dd></dl>

<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">範囲タイプDDLサポートは、Postgres DBAPIドライバで動作するはずですが、返されるデータ型は異なる場合があります。 `` psycopg2``を使用している場合は、これらのカラムタイプを使用する前にバージョン2.5以降にアップグレードすることをお勧めします。</p>
</div>
<p>これらの列型を使用するモデルをインスタンス化するときは、使用しているDBAPIドライバによって予期されるデータ型を列型として渡す必要があります。 `` psycopg2``の場合、 `` psycopg2.extras.NumericRange``、 `` psycopg2.extras.DateRange``、 `` psycopg2.extras.DateTimeRange``、 `` psycopg2.extras.DateTimeTZRange``またはクラス`` psycopg2.extras.register_range``で登録しました。</p>
<p>例えば：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">psycopg2.extras</span> <span class="kn">import</span> <span class="n">DateTimeRange</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.dialects.postgresql</span> <span class="kn">import</span> <span class="n">TSRANGE</span>

<span class="k">class</span> <span class="nc">RoomBooking</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>

    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&#39;room_booking&#39;</span>

    <span class="n">room</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">(),</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">during</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">TSRANGE</span><span class="p">())</span>

<span class="n">booking</span> <span class="o">=</span> <span class="n">RoomBooking</span><span class="p">(</span>
    <span class="n">room</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span>
    <span class="n">during</span><span class="o">=</span><span class="n">DateTimeRange</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> <span class="bp">None</span><span class="p">)</span>
<span class="p">)</span></pre></div>
</div>
</div>
</div>
<div class="section" id="postgresql-constraint-types">
<h2>PostgreSQLの制約の種類<a class="headerlink" href="#postgresql-constraint-types" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>SQLAlchemyはPostgreSQL EXCLUDE制約を次のようにサポートしています：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>ExcludeConstraint`クラス：</p>
<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.ExcludeConstraint">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.</code><code class="descname">ExcludeConstraint</code><span class="sig-paren">(</span><em>*elements</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ExcludeConstraint" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/constraints.html#sqlalchemy.schema.ColumnCollectionConstraint" title="sqlalchemy.schema.ColumnCollectionConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.schema.ColumnCollectionConstraint</span></code></a></p>
<p>表レベルのEXCLUDE制約。</p>
<p><a href="#id1"><span class="problematic" id="id2">`</span></a>postgres documentation`で説明されているように、EXCLUDE制約を定義します。</p>
<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.ExcludeConstraint.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>*elements</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.ExcludeConstraint.__init__" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.ExcludeConstraint`オブジェクトを作成します。</p>
<p>例えば：：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">const</span> <span class="o">=</span> <span class="n">ExcludeConstraint</span><span class="p">(</span>
    <span class="p">(</span><span class="n">Column</span><span class="p">(</span><span class="s1">&#39;period&#39;</span><span class="p">),</span> <span class="s1">&#39;&amp;&amp;&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="n">Column</span><span class="p">(</span><span class="s1">&#39;group&#39;</span><span class="p">),</span> <span class="s1">&#39;=&#39;</span><span class="p">),</span>
    <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">Column</span><span class="p">(</span><span class="s1">&#39;group&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;some group&#39;</span><span class="p">)</span>
<span class="p">)</span></pre></div>
</div>
<p>この制約は、通常：class： <cite>.Table`構造体に直接埋め込まれます。または、後で：meth：</cite> .append_constraint`</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">some_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span>
    <span class="s1">&#39;some_table&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">TSRANGE</span><span class="p">()),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">String</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">some_table</span><span class="o">.</span><span class="n">append_constraint</span><span class="p">(</span>
    <span class="n">ExcludeConstraint</span><span class="p">(</span>
        <span class="p">(</span><span class="n">some_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> <span class="s1">&#39;&amp;&amp;&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">some_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">group</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">),</span>
        <span class="n">where</span><span class="o">=</span><span class="n">some_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">group</span> <span class="o">!=</span> <span class="s1">&#39;some group&#39;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;some_table_excl_const&#39;</span>
    <span class="p">)</span>
<span class="p">)</span></pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメータ:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="sqlalchemy.dialects.postgresql.ExcludeConstraint.params.*elements"></span><strong>*elements</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.ExcludeConstraint.params.*elements">¶</a> -- &amp;quot;列&amp;quot;がSQL式要素または生のSQL文字列、最も一般的には：class： <cite>.Column`オブジェクトと&amp;quot;演算子である ``（列、演算子） ``形式の2つのタプルのシーケンス&amp;quot;は、使用する演算子を含む文字列です。 .. note :: &amp;quot;列&amp;quot;の値のために渡されるプレーンな文字列は、任意のSQL式として解釈されます。単純な文字列を渡すときには、必要な引用およびエスケープ構文を手動で適用する必要があります。 a：class： `.Column`オブジェクトが利用できないときに列名を指定するために、必要なクォート規則が有効になるようにして、ad-hoc：class：</cite> .Column`または：func： <a href="#id1"><span class="problematic" id="id2">`</span></a>.sql。 expression.column`オブジェクトを使用することができます。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.ExcludeConstraint.params.name"></span><strong>name</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.ExcludeConstraint.params.name">¶</a> -- オプションで、この制約のデータベース内の名前。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.ExcludeConstraint.params.deferrable"></span><strong>deferrable</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.ExcludeConstraint.params.deferrable">¶</a> -- オプションのbool。設定されている場合は、この制約に対してDDLを発行するときにDEFERRABLEまたはNOT DEFERRABLEを発行します。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.ExcludeConstraint.params.initially"></span><strong>initially</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.ExcludeConstraint.params.initially">¶</a> -- オプションの文字列。設定されている場合は、INITIALLY &lt;value&gt;この制約のDDLを発行するとき。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.ExcludeConstraint.params.using"></span><strong>using</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.ExcludeConstraint.params.using">¶</a> -- オプションの文字列。設定されている場合は、USINGを発行します。 &lt;index_method&gt;この制約のDDLを発行するとき。デフォルトは &amp;#39;gist&amp;#39;です。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.ExcludeConstraint.params.where"></span><strong>where</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.ExcludeConstraint.params.where">¶</a> -- オプションのSQL式構成またはリテラルSQL文字列。設定されている場合は、WHERE &lt;predicate&gt;この制約のDDLを発行するとき。 .. note ::ここで渡される単純文字列は、任意のSQL式として解釈されます。単純な文字列を渡すときには、必要な引用およびエスケープ構文を手動で適用する必要があります。</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<p>例えば：：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects.postgresql</span> <span class="k">import</span> <span class="n">ExcludeConstraint</span><span class="p">,</span> <span class="n">TSRANGE</span>

<span class="k">class</span> <span class="nc">RoomBooking</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>

    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&#39;room_booking&#39;</span>

    <span class="n">room</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">(),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">during</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">TSRANGE</span><span class="p">())</span>

    <span class="n">__table_args__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">ExcludeConstraint</span><span class="p">((</span><span class="s1">&#39;room&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;during&#39;</span><span class="p">,</span> <span class="s1">&#39;&amp;&amp;&#39;</span><span class="p">)),</span>
    <span class="p">)</span></pre></div>
</div>
</div>
<div class="section" id="postgresql-dml-constructs">
<h2>PostgreSQLのDML構文<a class="headerlink" href="#postgresql-dml-constructs" title="このヘッドラインへのパーマリンク">¶</a></h2>
<dl class="function">
<dt id="sqlalchemy.dialects.postgresql.dml.insert">
<code class="descclassname">sqlalchemy.dialects.postgresql.dml.</code><code class="descname">insert</code><span class="sig-paren">(</span><em>table</em>, <em>values=None</em>, <em>inline=False</em>, <em>bind=None</em>, <em>prefixes=None</em>, <em>returning=None</em>, <em>return_defaults=False</em>, <em>**dialect_kw</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.dml.insert" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>新しい：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Insert`オブジェクトを作成します。</p>
<p>このコンストラクタはパブリックAPI関数としてミラー化されています。完全な使い方と引数の説明については：func： <a href="#id1"><span class="problematic" id="id2">`</span></a>〜.dialects.mysql.insert`を参照してください。</p>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.dialects.postgresql.dml.Insert">
<em class="property">class </em><code class="descclassname">sqlalchemy.dialects.postgresql.dml.</code><code class="descname">Insert</code><span class="sig-paren">(</span><em>table</em>, <em>values=None</em>, <em>inline=False</em>, <em>bind=None</em>, <em>prefixes=None</em>, <em>returning=None</em>, <em>return_defaults=False</em>, <em>**dialect_kw</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.dml.Insert" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../core/dml.html#sqlalchemy.sql.expression.Insert" title="sqlalchemy.sql.expression.Insert"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.sql.expression.Insert</span></code></a></p>
<p>PostgreSQL固有のINSERTの実装。</p>
<p>ON CONFLICTなどのPG固有の構文のメソッドを追加します。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.1 で追加.</span></p>
</div>
<dl class="attribute">
<dt id="sqlalchemy.dialects.postgresql.dml.Insert.excluded">
<code class="descname">excluded</code><a class="headerlink" href="#sqlalchemy.dialects.postgresql.dml.Insert.excluded" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ON CONFLICT文に `` excluded``名前空間を提供する</p>
<p>PGのON CONFLICT節は、挿入される行を参照することを可能にします。これは <a href="#id1"><span class="problematic" id="id2">``</span></a>除外 <a href="#id3"><span class="problematic" id="id4">``</span></a>と呼ばれます。この属性は、この行のすべての列を参照可能にします。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">：ref： <cite>postgresql_insert_on_conflict</cite>  - 使用方法の例：attr：` .Insert.excluded`</p>
</div>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_nothing">
<code class="descname">on_conflict_do_nothing</code><span class="sig-paren">(</span><em>constraint=None</em>, <em>index_elements=None</em>, <em>index_where=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_nothing" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ON CONFLICT句のDO NOTHINGアクションを指定します。</p>
<p>`` constraint``と `` index_elements``の引数はオプションですが、これらの引数の1つだけを指定することができます。</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメータ:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_nothing.params.constraint"></span><strong>constraint</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_nothing.params.constraint">¶</a> -- 表に対する一意制約または除外制約の名前、または.name属性を持つ制約オブジェクト自体。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_nothing.params.index_elements"></span><strong>index_elements</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_nothing.params.index_elements">¶</a> -- 文字列の列名、：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Column`オブジェクト、またはターゲットインデックスを推論するために使用される他の列式オブジェクトからなるシーケンス。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_nothing.params.index_where"></span><strong>index_where</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_nothing.params.index_where">¶</a> -- 条件付きターゲット索引を推論するために使用できる追加のWHERE条件。 .. versionadded :: 1.1</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">：ref： <cite>postgresql_insert_on_conflict</cite></p>
</div>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_update">
<code class="descname">on_conflict_do_update</code><span class="sig-paren">(</span><em>constraint=None</em>, <em>index_elements=None</em>, <em>index_where=None</em>, <em>set_=None</em>, <em>where=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_update" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ON CONFLICT句のDO UPDATE SETアクションを指定します。</p>
<p>`` constraint``または `` index_elements``のいずれかの引数が必要ですが、どちらか一方しか指定できません。</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメータ:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_update.params.constraint"></span><strong>constraint</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_update.params.constraint">¶</a> -- 表に対する一意制約または除外制約の名前、または.name属性を持つ制約オブジェクト自体。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_update.params.index_elements"></span><strong>index_elements</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_update.params.index_elements">¶</a> -- 文字列の列名、：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Column`オブジェクト、またはターゲットインデックスを推論するために使用される他の列式オブジェクトからなるシーケンス。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_update.params.index_where"></span><strong>index_where</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_update.params.index_where">¶</a> -- 条件付きターゲット索引を推論するために使用できる追加のWHERE条件。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_update.params.set_"></span><strong>set_</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_update.params.set_">¶</a> -- 必須の引数。取得する `` SET``アクションを指定して、カラム名をキーとして、式やリテラルを値として持つ辞書やその他のマッピングオブジェクト。 target：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Column`が列名とは異なる&amp;quot;。key &amp;quot;属性を指定する場合、そのキーを使用する必要があります。 .. warning ::この辞書は、Pythonで指定されたデフォルトのUPDATE値や生成関数を考慮していません。例えば、：paramref： <a href="#id3"><span class="problematic" id="id4">`</span></a>.Column.onupdate`を使って指定したものです。これらの値は、：paramref： <a href="#id5"><span class="problematic" id="id6">`</span></a>.Insert.on_conflict_do_update.set_`ディクショナリで手動で指定されていない限り、ON CONFLICTスタイルのUPDATEスタイルに対しては使用されません。</li>
<li><span class="target" id="sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_update.params.where"></span><strong>where</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.postgresql.dml.Insert.on_conflict_do_update.params.where">¶</a> -- オプションの引数。存在する場合、 `` DO UPDATE SET``の影響を受ける行を制限する `` WHERE``節のためのリテラルSQLストリングまたは許容可能な式にすることができます。 `` WHERE``条件を満たす行は更新されません（事実上、これらの行に対しては `` DO NOTHING``）。 .. versionadded :: 1.1</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">：ref： <cite>postgresql_insert_on_conflict</cite></p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-sqlalchemy.dialects.postgresql.psycopg2">
<span id="psycopg2"></span><h2>psycopg2<a class="headerlink" href="#module-sqlalchemy.dialects.postgresql.psycopg2" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Support for the PostgreSQL database via the psycopg2 driver.</p>
<div class="section" id="dialect-postgresql-psycopg2-url">
<h3>DBAPI<a class="headerlink" href="#dialect-postgresql-psycopg2-url" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Documentation and download information (if applicable) for psycopg2 is available at:
<a class="reference external" href="http://pypi.python.org/pypi/psycopg2/">http://pypi.python.org/pypi/psycopg2/</a></p>
</div>
<div class="section" id="dialect-postgresql-psycopg2-connect">
<h3>Connecting<a class="headerlink" href="#dialect-postgresql-psycopg2-connect" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Connect String:<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>postgresql+psycopg2://user:password@host:port/dbname[?key=value&amp;key=value...]</pre></div>
</div>
</p>
</div>
<div class="section" id="psycopg2-connect-arguments">
<h3>psycopg2接続引数<a class="headerlink" href="#psycopg2-connect-arguments" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>psycopg2に固有のキーワード引数は、：func： <a href="#id1"><span class="problematic" id="id2">`</span></a>.create_engine（）`で受け付けます：</p>
<ul>
<li><p class="first">`` server_side_cursors``：この機能をサポートするSQL文に&amp;quot;サーバサイドカーソル&amp;quot;の使用を有効にします。これが本質的にpsycopg2の観点から意味することは、名前が `` connection.cursor（ &amp;#39;some name&amp;#39;） <a href="#id1"><span class="problematic" id="id2">``</span></a>などの名前を使ってカーソルが作成され、結果行がすぐにプリフェッチされてバッファに入れられないafterステートメントの実行ではなく、サーバー上に残され、必要に応じて検索されます。 SQLAlchemyの：class： <a href="#id3"><span class="problematic" id="id4">`</span></a>〜sqlalchemy.engine.ResultProxy`は、この機能が有効になっているときに特殊な行バッファリング動作を使用します。一度に100行ずつのグループをワイヤでフェッチして会話のオーバーヘッドを減らします。 ：paramref： <a href="#id5"><span class="problematic" id="id6">`</span></a>.Connection.execution_options.stream_results`実行オプションは、実行ごとにこのモードを有効にするよりターゲットを絞った方法です。</p>
</li>
<li><p class="first">`` use_native_unicode``：接続ごとにPsycopg2 &amp;quot;native unicode &amp;quot;モードの使用を有効にします。デフォルトではTrueです。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">：ref： <cite>psycopg2_disable_native_unicode</cite></p>
</div>
</li>
<li><p class="first">`` isolation_level``：このオプションは、すべてのPostgreSQLの方言で利用でき、psycopg2方言を使用するときは `` AUTOCOMMIT``分離レベルを含みます。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">：ref： <cite>psycopg2_isolation_level</cite></p>
</div>
</li>
<li><p class="first">`` client_encoding``：psycopg2の `` set_client_encoding（） <a href="#id1"><span class="problematic" id="id2">``</span></a>メソッドを使って、クライアントのエンコーディングをlibpqに無関係に設定します。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">：ref： <cite>psycopg2_unicode</cite></p>
</div>
</li>
<li><p class="first">`` use_batch_mode``：このフラグは：class： <cite>.Engine`によって実行される</cite> <cite>cursor.executemany（）</cite> <cite>呼び出しに対して</cite> <a href="#id1"><span class="problematic" id="id2">`</span></a>psycopg2.extras.execute_batch``を許可します。現在は実験的ですが、executemanyのパフォーマンスにとって重要なので、デフォルトではTrueになる可能性があります。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">：ref： <cite>psycopg2_batch_mode</cite></p>
</div>
</li>
</ul>
</div>
<div class="section" id="unix-domain-connections">
<h3>Unixドメイン接続<a class="headerlink" href="#unix-domain-connections" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>psycopg2はUnixドメイン接続による接続をサポートしています。 URLの `` host``部分が省略された場合、SQLAlchemyは `` None``をTCP / IP通信ではなくUnix-domain通信を指定するpsycopg2に渡します:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql+psycopg2://user:password@/dbname&quot;</span><span class="p">)</span></pre></div>
</div>
<p>デフォルトでは、使用されるソケットファイルは、 `` / tmp``のUnixドメインソケット、またはPostgreSQLがビルドされたときに指定されたソケットディレクトリに接続することです。この値は、パス名をpsycopg2に渡すことで上書きできます。追加のキーワード引数として `` host``を使用します：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql+psycopg2://user:password@/dbname?</span><span class="se">\</span></pre></div>
</div>
<p>ホスト= / var / lib / postgresql &amp;quot;）</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last"><a href="#id1"><span class="problematic" id="id2">`</span></a>PQconnectdbParams &lt;<a class="reference external" href="http://www.postgresql.org/docs/9.1/static/libpq-connect.html#LIBPQ-PQCONNECTDBPARAMS">http://www.postgresql.org/docs/9.1/static/libpq-connect.html#LIBPQ-PQCONNECTDBPARAMS</a>&gt; <a href="#id3"><span class="problematic" id="id4">`</span></a>_</p>
</div>
</div>
<div class="section" id="per-statement-connection-execution-options">
<span id="psycopg2-execution-options"></span><h3>Per Statement / Connection実行オプション<a class="headerlink" href="#per-statement-connection-execution-options" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>次のDBAPI固有のオプションは、DBAPIに固有ではないものに加えて：meth： <cite>.Connection.execution_options</cite>、：meth：` .Executable.execution_options`、：meth： <a href="#id1"><span class="problematic" id="id2">`</span></a>.Query.execution_options`で使用すると尊重されます。</p>
<ul>
<li><p class="first">`` isolation_level``  - ：class： <cite>.Connection`の寿命の間、トランザクション分離レベルを設定します（接続でのみ設定でき、文やクエリでは設定できません）。 See：ref： `psycopg2_isolation_level</cite>。</p>
</li>
<li><p class="first">`` stream_results``  -  psycopg2サーバサイドカーソルの使用を有効または無効にする - この機能は特別な結果処理メソッドと組み合わせて&amp;quot;名前付き&amp;quot;カーソルを使用して、結果行が完全にバッファされないようにします。 `` None``または設定されていない場合、：class： <cite>.Engine`の</cite> <a href="#id1"><span class="problematic" id="id2">`</span></a>server_side_cursors``オプションが使用されます。</p>
</li>
<li><p class="first">`` max_row_buffer``  -  `` stream_results``を使うとき、一度にバッファする最大行数を指定する整数値です。これは：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.BufferedRowResultProxy`によって解釈され、省略された場合、バッファは最終的に一度に1000行ずつ格納されるようになります。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.0.6 で追加.</span></p>
</div>
</li>
</ul>
</div>
<div class="section" id="psycopg2-batch-mode-fast-execution">
<span id="psycopg2-batch-mode"></span><h3>Psycopg2バッチモード（高速実行）<a class="headerlink" href="#psycopg2-batch-mode-fast-execution" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>psycopg2の最新バージョンには、 <cite>Fast Executionヘルパー&lt;http://initd.org/psycopg/docs/extras.html#fast-execution-helpers&gt; `_ &amp;#39;は、INSERTSを使用してpsycopg2のexecutemany（）パフォーマンスを複数の桁で改善するためのベンチマークで示されています。 SQLAlchemyは、複数のパラメータセットとともに使用される場合、class： `.Engine`によって呼び出されるすべての</cite> <cite>executemany（）</cite> <cite>スタイルコールに対してこの拡張を使用できます：</cite> <cite>use_batch_mode``フラグを：func：`に追加します。 create_engine</cite></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span>
    <span class="s2">&quot;postgresql+psycopg2://scott:tiger@host/dbname&quot;</span><span class="p">,</span>
    <span class="n">use_batch_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></pre></div>
</div>
<p>バッチモードは現時点で**実験的**とみなされますが、将来のリリースではデフォルトで有効になる可能性があります。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.2.0 で追加.</span></p>
</div>
</div>
<div class="section" id="unicode-with-psycopg2">
<span id="psycopg2-unicode"></span><h3>Psycopg2のUnicode<a class="headerlink" href="#unicode-with-psycopg2" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>デフォルトでは、psycopg2ドライバは `` psycopg2.extensions.UNICODE``拡張を使用します。これにより、DBAPIはすべての文字列をPython Unicodeオブジェクトとして直接受け取って返します.SQLAlchemyはこれらの値をそのまま渡します。 Psycopg2は現在の &amp;quot;クライアントエンコーディング&amp;quot;設定に基づいて文字列値をエンコード/デコードします。デフォルトではこれは `` postgresql.conf``ファイルの値です。デフォルトでは `` SQL_ASCII``がデフォルトです。通常、これはより便利なデフォルトの `` utf8``に変更することができます:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># postgresql.conf file</span>

<span class="c1"># client_encoding = sql_ascii # actually, defaults to database</span>
                             <span class="c1"># encoding</span>
<span class="n">client_encoding</span> <span class="o">=</span> <span class="n">utf8</span></pre></div>
</div>
<p>クライアントエンコーディングに影響を与えるもう1つの方法は、Psycopg2内でローカルに設定することです。 SQLAlchemyは `` client_encoding``パラメータを使って：func： <cite>.create_engine`に渡される値に基づいて、すべての新しい接続に対してpsycopg2：meth：</cite> psycopg2：connection.set_client_encoding`メソッドを呼び出します:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># set_client_encoding() setting;</span>
<span class="c1"># works for *all* PostgreSQL versions</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql://user:pass@host/dbname&quot;</span><span class="p">,</span>
                       <span class="n">client_encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span></pre></div>
</div>
<p>これは、PostgreSQLクライアント設定で指定されたエンコーディングをオーバーライドします。このようにパラメータを使用すると、psycopg2ドライバは接続上で明示的に `` SET client_encoding TO &amp;#39;utf8&amp;#39;``を発行し、すべてのPostgreSQLバージョンで動作します。</p>
<p>：func： <cite>.create_engine`に渡される</cite> <cite>client_encoding``の設定は**最近追加された</cite> <cite>client_encoding``のパラメータと同じではありません**現在libpqが直接サポートしています。これは `</cite> client_encoding``が `` psycopg2.connect（） <a href="#id1"><span class="problematic" id="id2">``</span></a>に直接渡され、SQLAlchemyから：paramref： <a href="#id3"><span class="problematic" id="id4">`</span></a>.create_engine.connect_args`パラメータを使って渡されるときに有効になります:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># libpq direct parameter setting;</span>
<span class="c1"># only works for PostgreSQL **9.1 and above**</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql://user:pass@host/dbname&quot;</span><span class="p">,</span>
                       <span class="n">connect_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;client_encoding&#39;</span><span class="p">:</span> <span class="s1">&#39;utf8&#39;</span><span class="p">})</span>

<span class="c1"># using the query string is equivalent</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql://user:pass@host/dbname?client_encoding=utf8&quot;</span><span class="p">)</span></pre></div>
</div>
<p>上記のパラメータは、PostgreSQLのバージョン9.1以降のlibpqにのみ追加されています。したがって、前の方法を使用するとバージョン間のサポートが向上します。</p>
<div class="section" id="disabling-native-unicode">
<span id="psycopg2-disable-native-unicode"></span><h4>ネイティブUnicodeを無効にする<a class="headerlink" href="#disabling-native-unicode" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>SQLAlchemyには、psycopg2の `` UNICODE``拡張機能の使用をスキップし、代わりに独自のUnicodeエンコード/デコードサービスを利用するように指示することもできます。通常は、ユニコードを完全にサポートしていないDBAPIのみに予約されています。 `` use_native_unicode = False``を：func： <cite>.create_engine`に渡すと、</cite> <cite>psycopg2.extensions.UNICODE``の使用が無効になります。 SQLAlchemyは代わりに：func： `.create_engine</cite> `` encoding``パラメータの値を使用して、途中のバイトからデータをPythonバイトストリングにエンコードして返します。デフォルトは `` utf-8` <a href="#id1"><span class="problematic" id="id2">`</span></a>。 SQLAlchemy独自のUnicodeエンコード/デコード機能は、ほとんどのDBAPIが現在ユニコードを完全にサポートしているため、徐々に時代遅れになっています。</p>
</div>
</div>
<div class="section" id="bound-parameter-styles">
<h3>バウンド・パラメータ・スタイル<a class="headerlink" href="#bound-parameter-styles" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>psycopg2方言のデフォルトのパラメータスタイルは&amp;quot;pyformat &amp;quot;です。SQLは <a href="#id1"><span class="problematic" id="id2">``</span></a>％（paramname）s``スタイルでレンダリングされます。この形式には、実際にパーセント記号や括弧記号が含まれているような特殊な場合には対応していないという制約があります。多くの場合、SQLAlchemyは列の名前に基づいてバインドされたパラメータ名を生成するため、列名にこれらの文字が存在すると問題が発生する可能性があります。</p>
<p>問題の解決策は2つあります：class： <a href="#id1"><span class="problematic" id="id2">`</span></a>.schema.Column`には、名前にこれらの文字の1つが含まれています。一つは、そのような名前を持つカラムに対して：paramref： <a href="#id3"><span class="problematic" id="id4">`</span></a>.schema.Column.key`を指定することです:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">measurement</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;measurement&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;Size (meters)&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;size_meters&#39;</span><span class="p">)</span>
<span class="p">)</span></pre></div>
</div>
<p>上記のように、 `` measurement.insert（） <a href="#id1"><span class="problematic" id="id2">``</span></a>のようなINSERT文は、パラメータ名として `` size_meters``を使用し、 `` measurement.c.size_meters&amp;gt; 10``のようなSQL式は、 nameを `` size_meters``キーから取得します。</p>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 1.0.0 で変更: </span>- SQL expressions will use <code class="xref py py-attr docutils literal notranslate"><span class="pre">Column.key</span></code>
as the source of naming when anonymous bound parameters are created
in SQL expressions; previously, this behavior only applied to
<a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table.insert" title="sqlalchemy.schema.Table.insert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.insert()</span></code></a> and <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table.update" title="sqlalchemy.schema.Table.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.update()</span></code></a> parameter names.</p>
</div>
<p>もう1つの解決方法は、定位フォーマットを使用することです。 psycopg2は&amp;quot;format &amp;quot; paramstyleを使用できます。これは次のように渡すことができます：paramref： <cite>.create_engine.paramstyle</cite></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span>
    <span class="s1">&#39;postgresql://scott:tiger@localhost:5432/test&#39;</span><span class="p">,</span> <span class="n">paramstyle</span><span class="o">=</span><span class="s1">&#39;format&#39;</span><span class="p">)</span></pre></div>
</div>
<p>上記のエンジンでは、::のようなステートメントの代わりに</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">measurement</span> <span class="p">(</span><span class="s2">&quot;Size (meters)&quot;</span><span class="p">)</span> <span class="n">VALUES</span> <span class="p">(</span><span class="o">%</span><span class="p">(</span><span class="n">Size</span> <span class="p">(</span><span class="n">meters</span><span class="p">))</span><span class="n">s</span><span class="p">)</span>
<span class="p">{</span><span class="s1">&#39;Size (meters)&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span></pre></div>
</div>
<p>私たちは代わりに:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">measurement</span> <span class="p">(</span><span class="s2">&quot;Size (meters)&quot;</span><span class="p">)</span> <span class="n">VALUES</span> <span class="p">(</span><span class="o">%</span><span class="n">s</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">)</span></pre></div>
</div>
<p>上記の場合、辞書スタイルは位置スタイルを持つタプルに変換されます。</p>
</div>
<div class="section" id="transactions">
<h3>トランザクション<a class="headerlink" href="#transactions" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>psycopg2ダイアレクトは、SAVEPOINTと2フェーズコミット操作を完全にサポートしています。</p>
</div>
<div class="section" id="psycopg2-transaction-isolation-level">
<span id="psycopg2-isolation-level"></span><h3>Psycopg2トランザクション分離レベル<a class="headerlink" href="#psycopg2-transaction-isolation-level" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>：ref： <cite>postgresql_isolation_level`で説明したように、PostgreSQLのすべての方言は：func：</cite> .create_engine`に渡される `` isolation_level``パラメータと `` isolation_level``引数の両方によってトランザクション分離レベルの設定をサポートします。 ：meth： <cite>.Connection.execution_options</cite>。 psycopg2方言を使用する場合、これらのオプションはPostgreSQLディレクティブを発行するのではなく、psycopg2の `` set_isolation_level（） <a href="#id1"><span class="problematic" id="id2">``</span></a>接続メソッドを使用します。これは、いずれの場合でもpsycopg2のAPIレベルの設定が常に各トランザクションの開始時に発行されるためです。</p>
<p>psycopg2方言は、分離レベルのために次の定数をサポートしています。</p>
<ul class="simple">
<li>`` READ COMMITTED``</li>
<li>`` READ UNCOMMITTED``</li>
<li>`` REPEATABLE READ``</li>
<li><a href="#id1"><span class="problematic" id="id2">``</span></a>シリアル化可能 ``</li>
<li>`` AUTOCOMMIT``</li>
</ul>
<div class="versionadded">
<p><span class="versionmodified">バージョン 0.8.2 で追加: </span>psycopg2を使用する場合のAUTOCOMMIT分離レベルのサポート</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p>：ref： <cite>postgresql_isolation_level</cite></p>
<p class="last">：ref： <cite>pg8000_isolation_level</cite></p>
</div>
</div>
<div class="section" id="notice-logging">
<h3>通知ログ<a class="headerlink" href="#notice-logging" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>psycopg2方言は、 `` sqlalchemy.dialects.postgresql``ロガー経由でPostgreSQL NOTICEメッセージをロギングします:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;sqlalchemy.dialects.postgresql&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span></pre></div>
</div>
</div>
<div class="section" id="id5">
<h3>HSTOREタイプ<a class="headerlink" href="#id5" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>`` psycopg2``のDBAPIには、HSTORE型のマーシャリングをネイティブに処理する拡張機能が含まれています。 SQLAlchemy psycopg2方言は、psycopg2バージョン2.4以上が使用されている場合、デフォルトでこの拡張を有効にし、ターゲットデータベースが使用のために設定されたHSTOREタイプを持っていることが検出されます。言い換えれば、方言が最初に接続すると、次のようなシーケンスが実行されます。</p>
<ol class="arabic simple">
<li>`` psycopg2.extras.HstoreAdapter.get_oids（） <a href="#id1"><span class="problematic" id="id2">``</span></a>を使って利用可能なHSTOREのoidを要求してください。この関数がHSTORE識別子のリストを返した場合、 `` HSTORE``拡張が存在すると判断します。この機能は、インストールされたpsycopg2のバージョンがバージョン2.4未満の場合は**スキップされます**。</li>
<li>`` use_native_hstore``フラグがデフォルトの `` True``で、 `` HSTORE``が利用可能であることが検出された場合、 `` psycopg2.extensions.register_hstore（） <a href="#id1"><span class="problematic" id="id2">``</span></a>拡張が呼び出されますすべての接続。</li>
</ol>
<p>`` register_hstore（） <a href="#id1"><span class="problematic" id="id2">``</span></a>拡張は、SQL <a href="#id3"><span class="problematic" id="id4">**</span></a>の対象カラムのタイプにかかわらず、すべてのPython辞書がパラメータとして受け入れられるという効果があります。辞書は、この拡張によってテキストのHSTORE式に変換されます。この動作が望ましくない場合は、次のように `` use_native_hstore``を `` False``に設定してhstore拡張機能の使用を無効にしてください:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql+psycopg2://scott:tiger@localhost/test&quot;</span><span class="p">,</span>
            <span class="n">use_native_hstore</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></pre></div>
</div>
<p>`` psycopg2.extensions.register_hstore（） <a href="#id1"><span class="problematic" id="id2">``</span></a>拡張子が使われていない場合、 `` HSTORE``型は**まだサポートされています**。これは、パラメータ側と結果側の両方でPython辞書とHSTORE文字列形式の間の強制が、SQLAlchemy独自のマーシャリングロジック内で行われ、より性能の高い「psycopg2」ではなく行われることを意味します。</p>
</div>
</div>
<div class="section" id="module-sqlalchemy.dialects.postgresql.pg8000">
<span id="pg8000"></span><h2>pg8000<a class="headerlink" href="#module-sqlalchemy.dialects.postgresql.pg8000" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Support for the PostgreSQL database via the pg8000 driver.</p>
<div class="section" id="dialect-postgresql-pg8000-url">
<h3>DBAPI<a class="headerlink" href="#dialect-postgresql-pg8000-url" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Documentation and download information (if applicable) for pg8000 is available at:
<a class="reference external" href="https://pythonhosted.org/pg8000/">https://pythonhosted.org/pg8000/</a></p>
</div>
<div class="section" id="dialect-postgresql-pg8000-connect">
<h3>Connecting<a class="headerlink" href="#dialect-postgresql-pg8000-connect" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Connect String:<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>postgresql+pg8000://user:password@host:port/dbname[?key=value&amp;key=value...]</pre></div>
</div>
</p>
</div>
<div class="section" id="unicode">
<span id="pg8000-unicode"></span><h3>Unicode<a class="headerlink" href="#unicode" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>pg8000は、PostgreSQLの `` client_encoding``パラメータを使用して、サーバとの間で文字列値をエンコード/デコードします。デフォルトではこれは `` postgresql.conf``ファイルの値です。デフォルトでは `` SQL_ASCII``がデフォルトです。典型的には、これはより有用なデフォルトとして `` utf-8``に変更することができます:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#client_encoding = sql_ascii # actually, defaults to database</span>
                             <span class="c1"># encoding</span>
<span class="n">client_encoding</span> <span class="o">=</span> <span class="n">utf8</span></pre></div>
</div>
<p>`` client_encoding``は、SQLを実行してセッションに対してオーバーライドすることができます：</p>
<p>SET CLIENT_ENCODING TO &amp;#39;utf8&amp;#39;;</p>
<p>SQLAlchemyは `` client_encoding``パラメータを使って：func： <a href="#id1"><span class="problematic" id="id2">`</span></a>.create_engine`に渡された値に基づいて、この新しいSQLをすべての新しい接続で実行します:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span>
    <span class="s2">&quot;postgresql+pg8000://user:pass@host/dbname&quot;</span><span class="p">,</span> <span class="n">client_encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span></pre></div>
</div>
</div>
<div class="section" id="pg8000-transaction-isolation-level">
<span id="pg8000-isolation-level"></span><h3>pg8000トランザクション分離レベル<a class="headerlink" href="#pg8000-transaction-isolation-level" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>pg8000ダイアレクトは、：ref： <a href="#id1"><span class="problematic" id="id2">`</span></a>psycopg2 &lt;psycopg2_isolation_level&gt; <a href="#id3"><span class="problematic" id="id4">`</span></a>方言：</p>
<ul class="simple">
<li>`` READ COMMITTED``</li>
<li>`` READ UNCOMMITTED``</li>
<li>`` REPEATABLE READ``</li>
<li><a href="#id1"><span class="problematic" id="id2">``</span></a>シリアル化可能 ``</li>
<li>`` AUTOCOMMIT``</li>
</ul>
<div class="versionadded">
<p><span class="versionmodified">バージョン 0.9.5 で追加: </span>pg8000を使用する場合のAUTOCOMMIT分離レベルのサポート</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p>：ref： <cite>postgresql_isolation_level</cite></p>
<p class="last">：ref： <cite>psycopg2_isolation_level</cite></p>
</div>
</div>
</div>
<div class="section" id="module-sqlalchemy.dialects.postgresql.psycopg2cffi">
<span id="psycopg2cffi"></span><h2>psycopg2cffi<a class="headerlink" href="#module-sqlalchemy.dialects.postgresql.psycopg2cffi" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Support for the PostgreSQL database via the psycopg2cffi driver.</p>
<div class="section" id="dialect-postgresql-psycopg2cffi-url">
<h3>DBAPI<a class="headerlink" href="#dialect-postgresql-psycopg2cffi-url" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Documentation and download information (if applicable) for psycopg2cffi is available at:
<a class="reference external" href="http://pypi.python.org/pypi/psycopg2cffi/">http://pypi.python.org/pypi/psycopg2cffi/</a></p>
</div>
<div class="section" id="dialect-postgresql-psycopg2cffi-connect">
<h3>Connecting<a class="headerlink" href="#dialect-postgresql-psycopg2cffi-connect" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Connect String:<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>postgresql+psycopg2cffi://user:password@host:port/dbname[?key=value&amp;key=value...]</pre></div>
</div>
</p>
</div>
<p>`` psycopg2cffi``は、C層にCFFIを使う `` psycopg2``の適応です。これはPyPyなどでの使用に適しています。ドキュメンテーションは `` psycopg2``の通りです。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.0.0 で追加.</span></p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">：mod： <cite>sqlalchemy.dialects.postgresql.psycopg2</cite></p>
</div>
</div>
<div class="section" id="module-sqlalchemy.dialects.postgresql.pypostgresql">
<span id="py-postgresql"></span><h2>py-postgresql<a class="headerlink" href="#module-sqlalchemy.dialects.postgresql.pypostgresql" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Support for the PostgreSQL database via the py-postgresql driver.</p>
<div class="section" id="dialect-postgresql-pypostgresql-url">
<h3>DBAPI<a class="headerlink" href="#dialect-postgresql-pypostgresql-url" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Documentation and download information (if applicable) for py-postgresql is available at:
<a class="reference external" href="http://python.projects.pgfoundry.org/">http://python.projects.pgfoundry.org/</a></p>
</div>
<div class="section" id="dialect-postgresql-pypostgresql-connect">
<h3>Connecting<a class="headerlink" href="#dialect-postgresql-pypostgresql-connect" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Connect String:<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>postgresql+pypostgresql://user:password@host:port/dbname[?key=value&amp;key=value...]</pre></div>
</div>
</p>
</div>
</div>
<div class="section" id="module-sqlalchemy.dialects.postgresql.pygresql">
<span id="pygresql"></span><span id="dialect-postgresql-pygresql"></span><h2>pygresql<a class="headerlink" href="#module-sqlalchemy.dialects.postgresql.pygresql" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Support for the PostgreSQL database via the pygresql driver.</p>
<div class="section" id="dialect-postgresql-pygresql-url">
<h3>DBAPI<a class="headerlink" href="#dialect-postgresql-pygresql-url" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Documentation and download information (if applicable) for pygresql is available at:
<a class="reference external" href="http://www.pygresql.org/">http://www.pygresql.org/</a></p>
</div>
<div class="section" id="dialect-postgresql-pygresql-connect">
<h3>Connecting<a class="headerlink" href="#dialect-postgresql-pygresql-connect" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Connect String:<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>postgresql+pygresql://user:password@host:port/dbname[?key=value&amp;key=value...]</pre></div>
</div>
</p>
</div>
</div>
<div class="section" id="module-sqlalchemy.dialects.postgresql.zxjdbc">
<span id="zxjdbc"></span><h2>zxjdbc<a class="headerlink" href="#module-sqlalchemy.dialects.postgresql.zxjdbc" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Support for the PostgreSQL database via the zxJDBC for Jython driver.</p>
<div class="section" id="dialect-postgresql-zxjdbc-url">
<h3>DBAPI<a class="headerlink" href="#dialect-postgresql-zxjdbc-url" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Drivers for this database are available at:
<a class="reference external" href="http://jdbc.postgresql.org/">http://jdbc.postgresql.org/</a></p>
</div>
<div class="section" id="dialect-postgresql-zxjdbc-connect">
<h3>Connecting<a class="headerlink" href="#dialect-postgresql-zxjdbc-connect" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Connect String:<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">postgresql</span><span class="o">+</span><span class="n">zxjdbc</span><span class="p">:</span><span class="o">//</span><span class="n">scott</span><span class="p">:</span><span class="n">tiger</span><span class="nd">@localhost</span><span class="o">/</span><span class="n">db</span></pre></div>
</div>
</p>
</div>
</div>
</div>

    </div>

</div>

<div id="docs-bottom-navigation" class="docs-navigation-links, withsidebar">
        Previous:
        <a href="oracle.html" title="previous chapter">オラクル</a>
        Next:
        <a href="sqlite.html" title="next chapter">SQLite</a>

    <div id="docs-copyright">
        &copy; <a href="../copyright.html">Copyright</a> 2007-2018, the SQLAlchemy authors and contributors.
        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.8.1.
    </div>
</div>

</div>



        
        

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '../',
          VERSION:     '1.3.0b1',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>

    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>

    <!-- begin iterate through sphinx environment script_files -->
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- end iterate through sphinx environment script_files -->

    <script type="text/javascript" src="../_static/detectmobile.js"></script>
    <script type="text/javascript" src="../_static/init.js"></script>


    </body>
</html>


